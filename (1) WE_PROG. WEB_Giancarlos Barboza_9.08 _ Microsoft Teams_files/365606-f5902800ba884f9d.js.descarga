"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[365606],{811994:(e,n,t)=>{t.d(n,{Nv:()=>o,mu:()=>i,AZ:()=>r,dX:()=>a,k3:()=>s});const o="Calling",i={toggleInfoPane:"toggleInfoPane",toggleWebSearch:"toggleWebSearch",hideThreadPane:"hideThreadPane",showRecordingFeedbackDialog:"showRecordingFeedbackDialog",hideRecordingFeedbackDialog:"hideRecordingFeedbackDialog"},r={toggleInfoPane:e=>({originator:o,type:i.toggleInfoPane,data:e}),toggleWebSearch:e=>({originator:o,type:i.toggleWebSearch,data:e}),hideThreadPane:()=>({originator:o,type:i.hideThreadPane}),showRecordingFeedbackDialog:e=>({originator:o,type:i.showRecordingFeedbackDialog,data:e}),hideRecordingFeedbackDialog:()=>({originator:o,type:i.hideRecordingFeedbackDialog})};var a,s,c,l;!function(e){e.NoTranscript="NoTranscript",e.NoTranscriptPermission="NoTranscriptPermission",e.NoPermission="NoPermission",e.NotEnoughContent="NotEnoughContent",e.NotEnoughContentChannel="NotEnoughContentChannel",e.TranscriptIsDisabled="TranscriptIsDisabled",e.TranscriptOutsideOrgDisabled="TranscriptOutsideOrgDisabled",e.TranscriptDefaultDisabled="TranscriptDefaultDisabled",e.TranscriptNotSupported="TranscriptNotSupported",e.TranscriptAttendeeDisabled="TranscriptAttendeeDisabled",e.TranscriptGuestDisabled="TranscriptGuestDisabled",e.TranscriptWaitingOrPendingDisabled="TranscriptWaitingOrPendingDisabled",e.TranscriptFailedDisabled="TranscriptFailedDisabled"}(a||(a={})),function(e){e.TranscriptionUFD="TranscriptionUFD",e.CatchUpUFD="CatchUpUFD",e.WrapUpUFD="WrapUpUFD",e.CopilotOnlyTurnOffUFD="CopilotOnlyTurnOffUFD",e.UBAR="UBAR",e.CallingUBAR="CallingUBAR",e.CallingTranscriptionUFD="CallingTranscriptionUFD",e.Recap="Recap",e.MeetingDetails="MeetingDetails",e.ChatInfoPane="ChatInfoPane",e.ChatInfoPaneLightBackground="ChatInfoPaneLightBackground",e.ChatInfoPaneOngoingMeeting="ChatInfoPaneOngoingMeeting",e.ChatInfoPaneCallHighlights="ChatInfoPaneCallHighlights",e.MeetApp="MeetApp",e.CallSummary="CallSummary",e.CallSummaryTeamsPremium="CallSummaryTeamsPremium",e.CallTransfer="CallTransfer",e.ComposeChat="ComposeChat",e.ComposeChannelsPost="ComposeChannelsPost",e.ComposeChannelsReply="ComposeChannelsReply",e.ComposeChannelsQuickReply="ComposeChannelsQuickReply",e.ChannelInfoPane="ChannelInfoPane",e.ChannelThreadSummary="ChannelThreadSummary",e.OngoingMeetingChat="OngoingMeetingChat",e.PostMeetingChat="PostMeetingChat",e.Designer="Designer",e.DesignerDallE="DesignerDallE",e.CopilotBotQnA="CopilotBotQnA",e.CopilotBotCommanding="CopilotBotCommanding",e.CopilotBotUFD="CopilotBotUFD",e.GroupCopilot="GroupCopilot",e.CopilotSynthesis="CopilotSynthesis",e.FileSummary="FileSummary",e.ChatSummary="ChatSummary",e.LiveNotes="LiveNotes",e.QueuesApp="QueuesApp",e.ComposeChatQuotedReplySmartResponse="ComposeChatQuotedReplySmartResponse"}(s||(s={})),function(e){e.Chat="Chat",e.Meeting="Meeting"}(c||(c={})),function(e){e.VideoEffectsButton="video-effects-button",e.AvatarButton="effects-and-avatars-button"}(l||(l={}))},648085:(e,n,t)=>{var o;t.d(n,{M:()=>o}),function(e){e[e.Legacy=0]="Legacy",e[e.MeetingData=1]="MeetingData"}(o||(o={}))},170962:(e,n,t)=>{t.d(n,{d:()=>r,t:()=>m});var o=t(648085),i=t(81984);const r={publicCommercialCloud:"teams.microsoft.com",gccHighCloud:"gov.teams.microsoft.us",dodCloud:"dod.teams.microsoft.us",dev:"local.teams.office.com",devLive:"local.teams.live.com",liveCloud:"teams.live.com",ag08Cloud:"https://teams.eaglex.ic.gov",ag09Cloud:"https://teams.microsoft.scloud"},a=/^(\s|\/)+|(\s|\/)+$/g,s={pathNamesLength:4,threadIDIndex:2,secondPathName:"meetup-join"},c={pathNamesLength:2,meetingIDIndex:1,firstPathName:"meet"};function l(e,n){return[r.dev,r.publicCommercialCloud].includes(n)?[r.devLive,r.liveCloud].includes(e):!![r.devLive,r.liveCloud].includes(n)&&[r.dev,r.publicCommercialCloud].includes(e)}function d(e){let n;try{n=new URL(e)}catch(e){return!1}const t=n.pathname.replace(a,"").split("/");return t.length===s.pathNamesLength&&t[1]===s.secondPathName&&!!t[s.threadIDIndex]||t.length===c.pathNamesLength&&t[0]===c.firstPathName&&!!t[c.meetingIDIndex]}function u(e,n){let t;try{t=new URL(e)}catch(e){return!1}return!!d(e)&&l(t.hostname,n)}function g(e){return e.substring(e.lastIndexOf(":")+1)}const m={getMeetingLegacyURL:function(e){const{tenantId:n,organizerId:t,meetingCloud:o,conversationId:i,rootMessageId:r,messageId:a}=e,s=encodeURIComponent(i),c=encodeURIComponent(r),l=a||void 0,d=encodeURIComponent(JSON.stringify({Tid:n,Oid:t?g(t):"",MessageId:l}));if(s&&c&&t&&n&&o)return`https://${o}/l/meetup-join/${s}/${c}?context=${d}`},isCrossCloudMeetingJoinAttempt:function(e,n){return!(!e||n===e||l(e,n)||n===r.dev&&e===r.publicCommercialCloud||n===r.devLive&&e===r.liveCloud)},isCrossCloudMeetingJoinAttemptBetweenTFLAndTFW:l,isInteropJoinAttemptBetweenTFLAndTFW:function(e,n){return e===i.el.life&&n===i.el.prod||e===i.el.prod&&n===i.el.life},isCrossCloudMeetingJoinBetweenTFLAndTFWAllowed:u,isDeepLinkExecutionForCrossCloudMeetingJoinBetweenTFLAndTFWAllowed:function(e,n,t){let o,i;try{o=new URL(e).hostname,i=t&&u(n,o)}catch(e){i=!1}return i},isLegacyMeetingUrl:function(e){let n;try{n=new URL(e)}catch(e){return!1}const t=n.pathname.replace(a,"").split("/");return t.length===s.pathNamesLength&&t[1]===s.secondPathName&&!!t[s.threadIDIndex]},isMeetingUrl:d,isTFWDomain:function(e){return[r.dev,r.publicCommercialCloud].includes(e)},isTFWCloud:function(e){return e===i.el.prod},stripMriPrefix:g,isTFLMeetingURL:function(e){try{let n;return e&&(n=new URL(e)),[r.liveCloud,r.devLive].includes(n?.host)}catch(e){return!1}},getMeetingCloudDomain:function(e){switch(e.joinType){case o.M.Legacy:return e.meetingCloud;case o.M.MeetingData:if(e.meetingData?.meetingUrl){let n;try{n=new URL(e.meetingData?.meetingUrl)}catch(e){return""}return n.hostname}default:return""}}}},279535:(e,n,t)=>{t.d(n,{p:()=>i,n:()=>r});const o={2:"teams.microsoft.com",3:"teams.microsoft.com",4:"teams.microsoft.com",90:"teams.microsoft.com",91:"teams.microsoft.com",92:"teams.microsoft.com",93:"teams.live.com",94:"teams.live.com",95:"teams.live.com",990:"teams.microsoft.com",991:"teams.microsoft.com",992:"gov.teams.microsoft.us",993:"dod.teams.microsoft.us",994:"teams.microsoft.com",995:"teams.microsoft.com",996:"teams.microsoft.com",997:"teams.microsoftonline.cn"},i=(e,n,t,i)=>{const r=new RegExp(e||"^(?<meetingCloudKey>[1-8]|9+[0-8])[1-9][0-9]*$").exec(i),a=r?.groups?.meetingCloudKey,s={...o,...n};return s[a]?`https://${s[a]}/`:t},r=(e,n,t,o,r)=>{const a=i(e,n,t,o),s=new URL(`meet/${o}`,a);return r&&s.searchParams.append("p",r),s.toString()}},81984:(e,n,t)=>{var o,i,r,a;t.d(n,{Wx:()=>o,t:()=>i,kj:()=>r,el:()=>s,EE:()=>c,fj:()=>l,lr:()=>d,Rg:()=>u,iF:()=>g,dj:()=>m,PL:()=>p,Je:()=>h}),function(e){e[e.Skype=0]="Skype",e[e.AAD=1]="AAD",e[e.CAE=2]="CAE"}(o||(o={})),function(e){e.SkypeTokenRequired="skypeTokenRequired",e.TokenRequired="tokenRequired"}(i||(i={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.RestartDevice="RestartDevice"}(r||(r={})),function(e){e[e.Inactive=0]="Inactive",e[e.Staged=1]="Staged",e[e.GoingLive=2]="GoingLive",e[e.Live=4]="Live"}(a||(a={}));const s={prod:"prod",life:"life",dod:"dod",gcch:"gcch",gallatin:"gallatin",airgap08:"airgap08",airgap09:"airgap09"};var c,l,d;!function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(c||(c={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.OOF="OOF",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(l||(l={})),function(e){e.Required="Required",e.Optional="Optional",e.Resource="Resource",e.Organizer="Organizer",e.Room="Room"}(d||(d={}));const u={None:"None",Organizer:"Organizer",Tentative:"Tentative",Accepted:"Accepted",Declined:"Declined",NotResponded:"NotResponded"};var g,m;!function(e){e.Office="Office",e.Remote="Remote",e.Unspecified="Unspecified"}(g||(g={})),function(e){e.IsCancelled="isCancelled",e.IsOrganizer="isOrganizer",e.OrganizerAddress="organizerAddress"}(m||(m={}));const p={activeSectionChanged:"activeSectionChanged",activeSectionSourceChanged:"activeSectionSourceChanged",liveLayoutChanged:"liveLayoutChanged",sectionCleared:"sectionCleared",stagedLayoutChanged:"stagedLayoutChanged",notifyAlertStates:"notifyAlertStates"};var C,h;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(C||(C={})),function(e){e.CMDStableSourceInfo="CMDStableSourceInfo",e.Pluginless="Pluginless",e.Slimcore="Slimcore",e.TrouterCallingWeb="TrouterCallingWeb",e.CallStore="CallStore"}(h||(h={}))},374348:(e,n,t)=>{t.d(n,{KX:()=>l,fl:()=>u,Nl:()=>m,CE:()=>p,e9:()=>C,_O:()=>h,c1:()=>w,oT:()=>D,ac:()=>S});var o=t(279535),i=t(170962),r=t(332752),a=t(519250),s=t(364819);const c={"teams.microsoft.com":!1,"teams.live.com":!0},l=e=>!e||"MeetingData"!==e.joinType,d=e=>!e||"MeetingData"===e.joinType,u=({user:e,coreSettings:n})=>(0,a.M7)(e)?Boolean(n.get(r.w.Calling)?.enableImprovedFreemiumExperience):Boolean(n.get(r.w.Calling)?.enableMeetNowShareInvite),g=(e,n)=>{const{enableInstantMeeting:t}=e.get(r.w.Calendar),{enableMeetNowInLandingPage:o,enableMeetNowInChatList:i}=e.get(r.w.Calling);switch(n){case"calendar":case"calendarMigration":return Boolean(t);case"chatList":return Boolean(i);case"landingPage":return Boolean(o);default:return!1}},m=(e,n,t)=>{const{allowMeetNowPolicy:o,allowPrivateMeetNowPolicy:i}=e.get(r.w.Calling);return t?Boolean(g(e,n)&&i):Boolean(g(e,n)&&o)},p=(e,n,t,o)=>{if(t)return e;const i=C(n,o);return i&&w(n,i)?i:e},C=(e,n)=>{if(!n||(0,s.isEmpty)(n))return"";if(n.meetingUrl)return n.meetingUrl;if(!n.meetingCode||!n.passcode)return"";const[t,i,r]=f(e);return(0,o.n)(t,i,r,n.meetingCode,n.passcode)},h=(e,n)=>{const[t,i,r]=f(e);return n&&!(0,s.isEmpty)(n)&&n.meetingCode?(0,o.p)(t,i,r,n.meetingCode):r},f=e=>{const{meetingIdCloudRegex:n,meetingIdPrefixToCloud:t}=e.get(r.w.Calling),{deeplinkBaseUrl:o}=e.get(r.w.Auth);return[n,v(t),o]},v=e=>Array.isArray(e)?Object.assign({},...e.map((e=>({[e.prefix]:e.cloud})))):{},y=e=>Array.isArray(e)?Object.assign({},...e.map((e=>({[e.cloud]:e.shareMeetCodeLink})))):{},R=e=>{try{return new URL(e).hostname}catch{return""}},w=(e,n)=>{const t=e.get(r.w.Calling)?.cloudToShareMeetCodeLink,o={...c,...y(t)},i=R(n);return i in o&&o[i]},D=e=>e?l(e)?e.meetingCloud||"":d(e)?R(e.meetingData?.meetingUrl||""):"":"",S=e=>e?l(e)?i.t.getMeetingLegacyURL({tenantId:e.tenantId,organizerId:e.organizerId,meetingCloud:e.meetingCloud||"",conversationId:e.conversationId||"",messageId:e.messageId,rootMessageId:e.rootMessageId})||"":d(e)&&e.meetingData?.meetingUrl||"":""},519250:(e,n,t)=>{t.d(n,{M7:()=>r,iQ:()=>a});var o=t(332752),i=t(554404);const r=e=>e?.tenant?.type===i.qv.Freemium,a=({user:e,coreSettings:n})=>(e=>Boolean(e.get(o.w.Calling)?.enableImprovedFreemiumExperience))(n)&&r(e)},190959:(e,n,t)=>{t.d(n,{W:()=>r,k:()=>a});var o=t(513432);const i=o.createContext({titlebarHeight:0,enablePositioningShiftToCoverTarget:!1}),r=i.Provider,a=()=>o.useContext(i)},950804:(e,n,t)=>{t.d(n,{l:()=>P});var o=t(957032),i=t(513432),r=t(675853),a=t(272786),s=t(870402),c=t(78643),l=t(728177),d=t(332752),u=t(802756),g=t(684668),m=t(589256),p=t(362328);const C={kind:"Document",get definitions(){const e=(0,p.G)("mutation ComponentsCoreDialogV2UpdateExtendedEntityContainerStateMutation($containerState:ExtendedContainerState!,$windowId:ID) {updateExtendedEntityContainerState(containerState:$containerState,windowId:$windowId) @client}");return delete this.definitions,this.definitions=e.definitions}};const h=async(e,n,t,o,i,r,a)=>{if(e)return i.current=!0,n.setContainerState(o,!0),void(i.current=!1);if(t){i.current=!0;try{await t.mutate({mutation:C,variables:{containerState:o,windowId:a}})}catch(e){r(`${o} mutation failed.`)}i.current=!1}else r("Apollo client does not exist. Unable to issue a mutation.")},f=async(e,n,t,o,i,r,a,s,c,l=!1,d=!1,u)=>{await h(e,n,t,"Open",s,i,u),l||d?r.requestAnimationFrame((()=>{a("CriticalInitRender"),o(!0),c()})):(a("CriticalInitRender"),o(!0),c())},v=async(e,n,t,o,i,r,a,s,c,l)=>{y(o,c),await h(e,n,t,c,s,a,l),r("UnmountStarted"),i(!1)},y=(e,n)=>{if(!e.findScenario(u.Cu.ExtensionClose)){e.newScenario(u.Cu.ExtensionClose).appendEventData({reason:n})}};var R=t(704284),w=t(31312),D=t(571621),S=t(850366),b=t(962687),I=t(880088),T=t(245434);const L=i.forwardRef(((e,n)=>{const{errorMessage:t,i18n:i}=e,r=i.translate("framework","dialog_error_message_generic"),a=i.translate("framework","dialog_error_cancel");return(0,o.Y)(w.E,{ref:n,children:(0,o.Y)(D.R,{children:[(0,o.Y)(S.L,{children:t??r}),(0,o.Y)(b.i,{children:(0,o.Y)(I.z,{children:(0,o.Y)(T.$,{children:a})})})]})})}));var F=t(208373);const M=i.memo((e=>{const{errorMessage:n,newLogger:t,i18n:r,children:a,...s}=e,[c,l]=i.useState(!1),d=i.useCallback((()=>{l(!0)}),[l]);return(0,o.Y)(F.g,{onError:d,newLogger:t,children:(0,o.Y)(R.l,{...s,children:c?(0,o.Y)(L,{errorMessage:n,i18n:r}):a})})}));var k=t(390373);const P=i.memo((({onOpenChange:e,open:n=!0,confirmed:t,cancelled:u,...p})=>{const C=(0,s.ur)().loggerFactory.newLogger,y=(0,k.PO)(),R=function(e){const{cancelled:n,confirmed:t,onOpen:o,open:u=!0}=e,{error:p}=(0,r.U)("Dialog Container"),C=i.useContext((0,g.l)()).client,y=i.useRef(!1),R=i.useRef(!1),w=i.useRef(!1),D=i.useRef(!0),[S,b]=(0,m.i)({defaultState:void 0,state:u,initialState:!1}),{onRenderEvent:I}=(0,a.At)(),{host:T,scenarioFactory:L}=(0,s.ur)(),F=i.useCallback((e=>{w.current&&b(e)}),[b,w]),{enableHybridExperienceRendererLayout:M}=(0,l.w2)(d.w.Host,["enableHybridExperienceRendererLayout"]),{enableRAFInCoreDialog:k}=(0,l.w2)(d.w.Core,["enableRAFInCoreDialog"]),P=(0,c.C)(),U=P?.windowId||"",A=P?.activeWindowService?.modalManager,{enableDecoupleCommandingFromResolversExtend:O=!1}=(0,l.w2)(d.w.Core,["enableDecoupleCommandingFromResolversExtend"]),E=i.useCallback((async()=>{await h(O,A,C,"Confirmed",y,p,U),await v(O,A,C,L,F,I,p,y,"Closed",U)}),[C,L,F,I,p,O,A,U]),N=i.useCallback((async()=>{await h(O,A,C,"Cancelled",y,p,U),v(O,A,C,L,F,I,p,y,"Closed",U)}),[C,L,F,I,p,O,A,U]),x=i.useCallback((()=>v(O,A,C,L,F,I,p,y,"Closed",U)),[C,L,F,I,p,O,A,U]),B=i.useCallback((()=>f(O,A,C,F,p,T,I,R,o,!!M,!!k,U)),[C,F,p,T,I,o,M,k,O,A,U]),W=i.useCallback((()=>w.current&&!y.current&&!R.current),[w,y,R]),_=i.useCallback((async()=>{W()&&(t?E():n&&N())}),[W,E,N,t,n]);return i.useLayoutEffect((()=>{D.current&&!u||t||(S?B():x())}),[t,S,u,B,x]),i.useEffect((()=>{D.current=!1}),[]),i.useLayoutEffect((()=>(w.current=!0,_(),()=>{w.current=!1})),[_,w]),w.current&&_(),S}({open:n,onOpen:i.useCallback((()=>{const n={};e?.(n,{event:n,open:!0,type:"triggerClick"})}),[e]),cancelled:u,confirmed:t});return(0,o.Y)(M,{open:R,...p,onOpenChange:e,newLogger:C,i18n:y})}))},208373:(e,n,t)=>{t.d(n,{g:()=>s});var o=t(957032),i=t(513432);const{memo:r}=i;class a extends i.PureComponent{constructor(e){super(e);const{newLogger:n}=this.props;this.logger=n("DialogContentErrorBoundary","components-core-dialog")}componentDidCatch(e,n){const t=`${e.name} ${e.message} componentStack: ${n.componentStack}`;this.logger.errorToTelemetry&&this.logger.errorToTelemetry(t,"webclient_framework_foundation_components_core_dialog",void 0,!0),this.props.onError()}render(){return this.props.children}}const s=r((e=>(0,o.Y)(a,{...e})))},704284:(e,n,t)=>{t.d(n,{l:()=>m});var o=t(513432),i=t(478304),r=t(680500),a=t(264278),s=t(744286),c=t(84994),l=t(277195);const d="--titlebar-height";var u=t(190959);const g=()=>{const e=o.useRef(null),{titlebarHeight:n}=(0,u.k)(),t=o.useRef(null),r=o.useRef(null),a=o.useRef(null),s=o.useCallback((e=>{null===a.current&&(a.current=()=>{e&&((e,n)=>{if(0===n||!(0,l.s)(e))return;e.style.removeProperty(d),e.getBoundingClientRect().top<n&&e.style.setProperty(d,`${n}px`)})(e,n)});const o=e?.ownerDocument?.defaultView;o?(r.current=o,o.addEventListener("resize",a.current),t.current=new o.ResizeObserver(a.current)):(r.current?.removeEventListener("resize",a.current),t.current?.disconnect())}),[n]),c=o.useCallback(((o,i)=>{n&&"enter"===i.direction&&e.current&&t.current&&t.current.observe(e.current)}),[n]);return{dialogSurfaceRef:(0,i.a)(e,s),handleMotionFinish:c}},m=o.memo((e=>{const n=(0,r.P)(e),{dialogSurfaceRef:t,handleMotionFinish:o}=g();n.dialogRef=(0,i.a)(n.dialogRef,t),n.surfaceMotion.onMotionFinish=(0,a.p)(n.surfaceMotion.onMotionFinish,o);const l=(0,c.C)(n);return(0,s.G)(n,l)}))}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/365606-f5902800ba884f9d.js.map