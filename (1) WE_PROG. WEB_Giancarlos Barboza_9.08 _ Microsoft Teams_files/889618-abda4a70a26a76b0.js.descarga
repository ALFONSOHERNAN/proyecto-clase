"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[889618],{698037:(e,t,n)=>{n.d(t,{hT:()=>i});n(364819);const i={chat:0,channel:0}},30728:(e,t,n)=>{var i,r,a;n.d(t,{t7:()=>i,ne:()=>r,j4:()=>a,ZM:()=>s}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp",e[e.Workflows=9]="Workflows",e[e.VirtualEvent=10]="VirtualEvent",e[e.BotFeedback=11]="BotFeedback",e[e.DeclarativeCopilot=12]="DeclarativeCopilot"}(i||(i={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(r||(r={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(a||(a={}));const s={message:"message",compose:"compose",commandBox:"commandBox",copilot:"copilot",thirdParty:"thirdParty",filesOnedrive:"filesOnedrive",filesSharepoint:"filesSharepoint"}},199631:(e,t,n)=>{var i;n.d(t,{m:()=>i}),function(e){e.APP_SWITCHER_CONFIRMATION_RENDERED="app-switcher-confirmation-renderer",e.AUDIO_DEVICE_SETTINGS_RENDERED="audio-device-settings-rendered",e.CALENDAR_HEADER_RENDERED="calendar-header-rendered",e.CALENDAR_VIEW_RENDERED="calendar-view-rendered",e.CALENDAR_SF_HEADER_RENDERED="calendar-sf-header-rendered",e.CALENDAR_SF_VIEW_RENDERED="calendar-sf-view-rendered",e.CALENDAR_SF_TRACKING_VIEW_RENDERED="calendar-sf-tracking-view-rendered",e.CALL_FORWARDING_SETTINGS_RENDERED="call-forwarding-settings-rendered",e.CALL_GROUP_OWNERS_RENDERED="call-group-owners-rendered",e.CALL_HISTORY_RENDERED="call-history-rendered",e.CALLS_APP_HEADER_RENDERED="calls-app-header-rendered",e.CALLS_APP_HISTORY_FETCH_STARTED="calls-app-history-fetch-started",e.CALLS_APP_HISTORY_FETCH_COMPLETED="calls-app-history-fetch-completed",e.CALLS_APP_SPEED_DIAL_FETCH_STARTED="calls-app-speed-dial-fetch-started",e.CALLS_APP_SPEED_DIAL_FETCH_COMPLETED="calls-app-speed-dial-fetch-completed",e.CALLING_SCREEN_RENDERED="calling-screen-rendered",e.CALLS_APP_RENDERED="calls-app-rendered",e.CAMPAIGN_VIEW_RENDERED="campaign-view-rendered",e.CHANNEL_DASHBOARD_HEADER_RENDERED="channel-dashboard-header-rendered",e.CHANNEL_DASHBOARD_VIEW_RENDERED="channel-dashboard-view-rendered",e.CHANNEL_HEADER_RENDERED="channel-header-rendered",e.CHANNEL_RIGHT_PANE_HEADER_RENDERED="channel-right-pane-header-rendered",e.CHANNEL_LIST_ITEMS_RENDERED="channel-list-items-rendered",e.COMMUNITIES_LIST_DATA_LOADED="communities-list-data-loaded",e.CHAT_HEADER_BUTTONS_RENDERED="chat-header-buttons-rendered",e.CHAT_HEADER_TITLE_RENDERED="chat-header-title-rendered",e.CHAT_LIST_ITEMS_RENDERED="chat-list-items-rendered",e.COMPOSE_LAYOUT_LOADED="compose-layout-loaded",e.COMPOSE_LOADED="compose-loaded",e.COMMUNITIES_HEADER_RENDERED="communities-header-rendered",e.COMMUNITIES_DATA_FETCHED_V2="communities-data-fetched-v2",e.COMMUNITIES_MANAGE_VIEW_RENDERED="communities-manage-view-rendered",e.COMMUNITIES_JOIN_INVITE_VIEW_RENDERED="communities-join-invite-view-rendered",e.COLLAB_STAGE_HEADER_TITLE_RENDERED="collab-stage-header-title-rendered",e.CONNECT_WITH_ANYONE_SHOWN="connect-with-anyone-shown",e.COURSE_TEAMS_MAIN_PANE_RENDERED="course-teams-main-pane-rendered",e.DIALPAD_RENDERED="dialpad-rendered",e.DISCOVER_SURFACE_FEED_RENDERED="discover-surface-feed-rendered",e.DISCOVER_SURFACE_HEADER_RENDERED="discover-surface-header-rendered",e.DISCOVER_SURFACE_VIEW_RENDERED="discover-surface-view-rendered",e.NO_FEED_GRAPHICS_RENDERED="no-feed-graphics-rendered",e.FEED_ITEM_NAVIGATION="feed-item-navigation",e.FEED_LIST_ITEMS_RENDERED="feed-list-items-rendered",e.FEED_SLICE_LIST_RENDERED="feed-slice-list-rendered",e.HELP_APP_RENDERED="help-app-rendered",e.GUARDIANS_APP_RENDERED="guardians-app-rendered",e.GATHER_APP_RENDERED="gather-app-rendered",e.LOB_NOTIFICATIONS_RENDERED="lob_notifications_rendered",e.MEET_APP_RENDERED="meet-app-rendered",e.MEETING_ROOM_FRONT_OF_ROOM_RENDERED="meeting-room-front-of-room-rendered",e.MEETING_ROOM_MAIN_SCREEN_RENDERED="meeting-room-main_screen-rendered",e.MEETING_ROOM_CONSOLE_UBAR_RENDERED="meeting-room-console-ubar-rendered",e.MEETING_ROOM_CONSOLE_ROSTER_RENDERED="meeting-room-console-roster-rendered",e.MEETING_ROOM_CONSOLE_MEETING_INFO_RENDERED="meeting-room-console-meeting-info-rendered",e.MEETING_ROOM_INCOMING_CALL_RENDERED="meeting-room-incoming-call-rendered",e.MESSAGE_REACTIONS_RENDERED="message-reactions-rendered",e.MESSAGES_RENDERED="messages-rendered",e.ONEUP_HEADER_RENDERED="oneup-header-rendered",e.ONEUP_RENDERED="oneup-rendered",e.PEOPLE_APP_RENDERED="people-app-rendered",e.PLATFORM_APP_CONTAINER_RENDERED="platform_app_container_rendered",e.PLATFORM_APP_FRAME_RENDERED="platform_app_frame_rendered",e.PLATFORM_APP_FRAME_CONTENT_RENDERED="platform_app_frame_content_rendered",e.P2P_FILES_LIST_VIEW_RENDERED="p2p_files_list_view_rendered",e.P2P_SHARED_LIST_VIEW_RENDERED="p2p_shared_list_view_rendered",e.PRESENCES_RENDERED="presences-rendered",e.QUEUES_APP_HEADER_STARTED="queues-app-header-started",e.QUEUES_APP_LEFT_STARTED="queues-app-left-started",e.QUEUES_APP_CENTER_STARTED="queues-app-center-started",e.QUEUES_APP_HEADER_DATA_LOADED="queues-app-header-data-loaded",e.QUEUES_APP_HEADER_RENDERED="queues-app-header-rendered",e.QUEUES_APP_CENTER_RENDERED="queues-app-center-rendered",e.QUEUES_APP_LEFT_RENDERED="queues-app-left-rendered",e.SEARCH_RESULTS_RENDERED="search-results-rendered",e.SETTINGS_RENDERED="settings-rendered",e.SHARE_PAGE_RENDERED="share-page-rendered",e.SHELL_APP_BAR_RENDERED="shell_app_bar_rendered",e.SHELL_TITLE_BAR_RENDERED="shell_title_bar_rendered",e.SINGLE_TEAM_VIEW_LEFT_RAIL_LOADED="single-team-view-left-rail-loaded",e.SIMPLE_COLLAB_ADAPTIVE_LEFT_RAIL_LOADED="simple-collab-adaptive-left-rail-loaded",e.SIMPLE_COLLAB_SLICE_FEED_RENDERED="simple-collab-slice-feed-rendered",e.SIMPLE_COLLAB_SLICE_LIST_RENDERED="simple-collab-slice-list-rendered",e.SIMPLE_COLLAB_SLICE_UNSELECTED_GRAPHIC_RENDERED="simple-collab-slice-unselected-graphic-rendered",e.SIMPLE_COLLAB_ZERO_STATE_RENDERED="simple-collab-zero-state-rendered",e.COACH_REPORT_VIEW_RENDERED="coach-report-view-rendered",e.SPEED_DIAL_RENDERED="speed-dial-rendered",e.TEAM_DASHBOARD_HEADER_RENDERED="team-dashboard-header-rendered",e.TEAM_DASHBOARD_VIEW_RENDERED="team-dashboard-view-rendered",e.TEAMS_DASHBOARD_HEADER_RENDERED="teams-dashboard-header-rendered",e.TEAMS_DASHBOARD_VIEW_RENDERED="teams-dashboard-view-rendered",e.TEAMS_GRID_VIEW_HEADER_RENDERED="teams-grid-view-header-rendered",e.TEAMS_GRID_VIEW_RENDERED="teams-grid-view-rendered",e.TFL_ONBOARDING_APP_RENDERED="tfl-onboarding-rendered",e.VIRTUAL_LIST_RENDER_BUFFER_FILLED="virtual-list-render-buffer-filled",e.USER_ONBOARDING_TO_TEAM_VIEW_RENDERED="user-onboarding-to-team-view-rendered",e.USER_ONBOARDING_HEADER_RENDERED="user-onboarding-header-rendered",e.MEETING_LINK_CARD_RENDERED="meeting-link-card-rendered",e.UPCOMING_EVENT_CARD_RENDERED="upcoming-event-card-rendered"}(i||(i={}))},328789:(e,t,n)=>{n.d(t,{J:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("mutation setPlatformAppsFetchPolicy($input:[PlatformAppsFetchPolicyInput!]!) {setPlatformAppsFetchPolicy(input:$input) @client}");return delete this.definitions,this.definitions=e.definitions}}},292992:(e,t,n)=>{n.d(t,{h:()=>a});var i=n(362328),r=n(780706);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment appDefinition on AppDefinition {id,name,developerName,developerUrl,privacyUrl,termsOfUseUrl,version,shortDescription,longDescription,profileCardDescription {isAIGenerated,actionSection {actionTitle,actionDescription}},smallImageUrl,largeImageUrl,accentColor,categories,validDomains,externalId,tenantId,isBlocked,isFullScreenApp,isFullTrustApp,isMicrosoftOwned,showTabLoadingIndicator,templatedAppId,bots {...botDefinition},customBots {endpointUrl,secret},connectors {connectorId,scopes,configurationUrl},galleryTabs {configurationUrl,canUpdateConfiguration,canHaveTabConversation,scopes,meetingSurfaces,context},staticTabs {entityId,name,order,contentUrl,contentBotId,websiteUrl,scopes,context,containerAppIds},meetingExtensionDefinition {isAnonymousAccessAllowed,supportsStreaming,supportsCustomShareToStage,scenes {id,name,file,preview,maxAudience,seatsReservedForOrganizersOrPresenters},filters {id,name,thumbnail},videoAppContentUrl},authorization {permissions {orgWide {name,type},resourceSpecific {name,type}}},messageExtensions {type,botId,canUpdateConfiguration,fetchCommands,scopes,commands {id,title,context,description,initialRun,type,parameters {name,title,description,inputType,value,isRequired,choices {title,value}},appKey,fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}},messageHandlers {type,value {domains,supportsAnonymousAccess}},authorization {authType,microsoftEntraConfiguration {supportsSingleSignOn}}},webApplicationInfo {id,appKey,resource,applicationPermissions},metaCapabilities {copilotPlugins {scopes},copilotExtensions {scopes},declarativeCopilots {scopes},customEngineCopilots {scopes}},screenshotUrls,officeAssetId,videoUrl,devicePermissions,securityComplianceInfo {mcasId,status,csaId,csaName},defaultInstallScope,defaultGroupCapability {team,groupchat,meetings},subscriptionOffer {offerId},manifestVersion,blockedConfigurations,backgroundLoadConfiguration {tabConfiguration {contentUrl}},copilotExtensions {customEngineCopilots {type,id},declarativeCopilots {id,isBlocked}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.x.definitions]}}},214919:(e,t,n)=>{n.d(t,{j:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment appsUsageFields on AppsUsage {appIds,appActions {appId,actionId},appCommands {appId,commandType,commandId},appScenes {appId,sceneId},appsMru {appId,lastUsedTimeStamp}}");return delete this.definitions,this.definitions=e.definitions}}},780706:(e,t,n)=>{n.d(t,{x:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment botDefinition on BotDefinition {id,scopes,capabilities {isNotificationOnly,supportsFiles,supportsCalling,supportsVideo},commandLists {commands {title,description},scopes},configuration {groupChat {fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}},team {fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}}},registrationInfo {source,environment}}");return delete this.definitions,this.definitions=e.definitions}}},441065:(e,t,n)=>{n.d(t,{q:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment consumptionHorizonBookmarkFields on ConsumptionHorizonBookmark {id,originalArrivalTime,timeStamp,clientMessageId}");return delete this.definitions,this.definitions=e.definitions}}},308696:(e,t,n)=>{n.d(t,{U:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment consumptionHorizonFields on ConsumptionHorizon {id,originalArrivalTime,timeStamp,clientMessageId}");return delete this.definitions,this.definitions=e.definitions}}},40341:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonActiveCallFragment on ActiveCallOfConversation {id,callType}");return delete this.definitions,this.definitions=e.definitions}}},566424:(e,t,n)=>{n.d(t,{h:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatAddMembersFragment on Conversation {id,cfet,chatSubType,guardianChatInfo,hasFederatedUser,hasTflConsumerUser,hasTflSmsUnverifiedUser,hasTflSmsVerifiedUser,isMeeting,isOneOnOne,isOneOnOneBotChat,isUserMember,memberIds,tflOffNetworkUserLength,tenantId,title,interopConversationStatus,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant},membersLimited {id,isFederated},botMembers {id},meetingChatType}");return delete this.definitions,this.definitions=e.definitions}}},361891:(e,t,n)=>{n.d(t,{Y:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatMtoTelemetryFragment on Conversation {id,hasFederatedMTOUser}");return delete this.definitions,this.definitions=e.definitions}}},627750:(e,t,n)=>{n.d(t,{F:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatPaneLayoutFragment on Conversation {id,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant}}");return delete this.definitions,this.definitions=e.definitions}}},48377:(e,t,n)=>{n.d(t,{Y:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatPinnedMessageFragment on Message {id,content,from,imDisplayName,messageType,originalArrivalTime,deleteTime,isSkypeMessage,files {id,itemId,type,title},cards {name,content,contentType,appId}}");return delete this.definitions,this.definitions=e.definitions}}},24706:(e,t,n)=>{n.d(t,{W:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatRecapFragment on Conversation {id,hasRecap}");return delete this.definitions,this.definitions=e.definitions}}},168328:(e,t,n)=>{n.d(t,{_:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatSmartCardInfoFragment on Conversation {id,smartCardInfo {id,summaryStartTime,unreadMessageCount,unreadMessagesContentLength},notes {id,isSynthesisAvailable,showConvergedUx},isMeeting,meetingInformation {id,iCalUid,meetingType,endTime,organizerId,tenantId},activeCall {id}}");return delete this.definitions,this.definitions=e.definitions}}},858863:(e,t,n)=>{n.d(t,{I:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatWithMtoUserBannerFragment on Conversation {id,firstMtoMember {id,homeMri,displayName},mtoHomeUserInfo {shouldChatWithFederatedIdentities,areAllChatMembersReachableInTheirHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}}},255368:(e,t,n)=>{n.d(t,{x:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonRecordingMessageMiFragment on MeetingInformation {id,meetingType,startTime,templateDetails {id}}");return delete this.definitions,this.definitions=e.definitions}}},703566:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonUseExternalTagFragment on Conversation {id,cfet,creator,hasFederatedUser,hasTflConsumerUser,isFederated,isExternal,isMeeting,isOneOnOne,tflOffNetworkUserLength,memberIds,membersLimited {id,displayName,givenName,isFederated}}");return delete this.definitions,this.definitions=e.definitions}}},502393:(e,t,n)=>{n.d(t,{P:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonUseMtoUserBannerFragment on Conversation {id,shortTitle,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}}},693968:(e,t,n)=>{n.d(t,{B:()=>l});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonInstallerIdentityFragment on InstallerIdentity {installerType,userId,azureAdAppId}");return delete this.definitions,this.definitions=e.definitions}};var a=n(590438),s=n(292992);const o={kind:"Document",get definitions(){const e=(0,i.G)("fragment appPermissions on AppPermissions {orgWide {name,type},resourceSpecific {name,type}}");return delete this.definitions,this.definitions=e.definitions}},l={kind:"Document",get definitions(){const e=(0,i.G)("fragment installedAppFields on InstalledApp {installedScope,id,installationState,installedAppProps {isUninstallable,isAdminPreInstalled,isNewGlobalPreInstalled,isNewAdminPreInstalled,isUnlicensed},conversationId,installedVersion,installerIdentity {...DataFragmentsCommonInstallerIdentityFragment},messageExtensionStates {...messageExtensionState},definition {...appDefinition},permissions {...appPermissions},statusInfo {status},botMetadata {registrationInfo {sourceAppId}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions,...a.O.definitions,...s.h.definitions,...o.definitions]}}},369847:(e,t,n)=>{n.d(t,{L:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment lastMessageFields on LastMessage {content,originalArrivalTime,imDisplayName,id,clientMessageId,from,messageType,deleteTime,mentions {id,itemId,userId,displayName,mentionType,appId},importance,files {id},cards {appIcon,appId,appName,cardClientId,content,contentType,locale,sourceType}}");return delete this.definitions,this.definitions=e.definitions}}},590438:(e,t,n)=>{n.d(t,{O:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment messageExtensionState on MessageExtensionState {botId,isPinned,pinOrder}");return delete this.definitions,this.definitions=e.definitions}}},189737:(e,t,n)=>{n.d(t,{M:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment pinnedMessageItemFields on Message {id}");return delete this.definitions,this.definitions=e.definitions}}},466548:(e,t,n)=>{n.d(t,{z:()=>r,x:()=>a});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment featureSettingsFields on UserFeatureSettingsInfo {coExistenceMode,isPrivateChatEnabled}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("fragment userFields on User {id,objectId,displayName,decoratedDisplayName,givenName,surname,email,emailsInfo {address,isPrimary},tenantId,tenantName,isFederated,jobTitle,department,featureSettings {...featureSettingsFields},type,profileType,userType,trustworthy {trustLevel,trustReason,trustLabel}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions]}}},690686:(e,t,n)=>{n.d(t,{p:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment userProperties on ConversationUserProperties {isMutedInChannel,role,maskId}");return delete this.definitions,this.definitions=e.definitions}}},688194:(e,t,n)=>{n.d(t,{lu:()=>i,fO:()=>r});const i=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},r=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e))},934238:(e,t,n)=>{n.d(t,{NX:()=>j,Lm:()=>Q,PN:()=>ie,qd:()=>X,Kj:()=>ne,Uv:()=>Z,OZ:()=>te,oq:()=>ee,Dc:()=>Dt,vc:()=>Qe,Lv:()=>$e,f4:()=>Re,jI:()=>be,qU:()=>De,KH:()=>Et,BO:()=>Ce,QM:()=>Se,UL:()=>We,Wk:()=>He,of:()=>Tt,Sd:()=>St,PH:()=>At,__:()=>ft,Fz:()=>yt,ic:()=>wt,gj:()=>_t,l7:()=>Ct,wD:()=>mt,fc:()=>It,zX:()=>vt,Rx:()=>Ft,S3:()=>Te,XO:()=>we,Xq:()=>Pe,OB:()=>tt,FC:()=>et,hE:()=>nt,FQ:()=>Fe,fO:()=>Ge,jp:()=>_e,qQ:()=>Xe,dM:()=>ye,fi:()=>se,bo:()=>pe,nT:()=>it,RE:()=>rt,_u:()=>ve,TH:()=>Ne,Ox:()=>gt});var i=n(332752),r=n(440320),a=n(942016),s=n(508411),o=n(239),l=n(848703),d=n(194649),c=n(46377),p=n(596497),u=n(676915),m=n(75914),h=n(260465),g=n(821296),f=n(576171),E=n(364819),y=n(698037),I=n(900301);class A{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:y.hT,timestamp:void 0}}static get instance(){return A._instance||(A._instance=new A),A._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:t}){this._enabled=e,t.infoToTelemetry?.("Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:y.hT}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:t}){this.isEnabled?(this._currentAppConsumptionHorizon=(0,E.clone)(e),t.infoToTelemetry?.(`AppConsumptionHorizon updated to '${(0,I.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)):t.warnToTelemetry?.(`Tried updating appConsumptionHorizon while singleton was disabled '${(0,I.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var C=n(997853);function T(){return A.instance.isEnabled}const S=e=>(0,C.$G)(e,T()?A.instance.currentAppConsumptionHorizon:void 0),v=e=>{let t="";return e&&(t=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),t};var _=n(339470),D=n(539299),b=n(804510),P=n(348103),N=n(648816),M=n(271126),R=n(785053),F=n(325759),w=n(586892),O=n(355515),U=n(34655);const L=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let n=x(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:i,eventRecurrencePattern:r}=e;return n=[...n,...k(i,t),...G(r,t)],n},k=(e,t)=>x(e,["startDate"],`${t}.eventRecurrenceRange`),G=(e,t)=>{let n=[];if(e){const{daily:i,weekly:r,monthly:a,yearly:s,relativeMonthly:o,relativeYearly:l}=e;n=[...x(e,["patternType"],`${t}.eventRecurrencePattern`),...x(i,["interval"],`${t}.eventRecurrencePattern.daily`),...x(r,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...x(a,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...x(s,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...x(o,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...x(l,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],r&&r.daysOfTheWeek&&r.daysOfTheWeek.some((e=>(0,E.isNil)(e)))&&n.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return n},x=(e,t,n)=>{const i=[];return(0,E.isNil)(e)||t.forEach((t=>{(0,E.isNil)(e[t])&&i.push(`${n}.${String(t)}`)})),i};var B=n(244698),$=n(438543),H=n(688194),W=n(389641);const V=e=>e&&e.vivaTopicsAnnotations?(e=>{try{return(e=>{const{ApiVersion:t,EntityAnnotation:n,TraceId:i,ClientRequestId:r}=e,{SectionMatches:a}=n;return{apiVersion:t,entityAnnotation:{sectionMatches:a.map((e=>{const{EntityMatches:t,SectionId:n}=e;return{entityMatches:t.map((e=>{const{Entities:t,HighlightedName:n,Length:i,StartPos:r,OccurrenceIndex:a,TotalOccurrences:s,Relevance:o}=e;return{entities:t.map((e=>{const{DisplayName:t,Id:n,RelevanceScore:i,Source:r,Type:a}=e;return{displayName:t,id:n,relevanceScore:i,source:r,type:a}})),highlightedName:n,length:i,startPos:r,occurrenceIndex:a,totalOccurrences:s,relevance:{annotationScore:o.AnnotationScore}}})),sectionId:n}}))},traceId:i,clientRequestId:r}})((0,W.n)(e))}catch(e){return}})(e.vivaTopicsAnnotations)??null:null;var q=n(378044);const z="http://schema.skype.com",J=`${z}/Mention`,Q=`${z}/File`,j=2,K=_.$,Y=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]),X="preview-",Z="newchat",ee="welcomePage",te="48:notes",ne="bizChatMetaOSChatListEntryPoint",ie="holisticRecapChatListEntryPoint",re=(e,t,n,i=!1)=>{if(!e?.emotions)return null;const r=e.emotions.map((({key:e,users:n})=>({key:e,users:n.map((({mri:n,time:i,value:r})=>({id:(0,N.zJ)(K(n),t,e),time:i,value:r,userId:K(n)}))).sort(((e,t)=>e.time-t.time))})));return i&&r.sort(((e,t)=>(n?.emotions?.[t.key]??t.users.length??0)-(n?.emotions?.[e.key]??e.users.length??0))),r},ae=(e,t)=>{if(!t||!t.emotions)return null;const n=t.emotions;return Object.keys(n).map((t=>({id:(0,N.io)(e,t),key:t,count:n[t]})))},se=(e,t,n)=>e&&e.mentions?de(e.mentions,t,n):null,oe=(e,t,n)=>e&&e.onbehalfof?de(e.onbehalfof,t,n):null,le=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},de=(e,t,n)=>{try{if("string"==typeof e&&(0,d.AF)(e))return null;const n="string"==typeof e?JSON.parse(e):e;return n?.length?n.map((({itemid:e,mri:n,appId:i,displayName:r,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,appId:i,displayName:r,mentionType:a}))):null}catch(e){const i=n?.newLogger("Chat Helper","data-resolvers-common");return i?.errorToTelemetry?.(`UnhandledException in messageId: ${t}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},ce=(e,t,n,i)=>{if(!t||!t.files)return null;const r=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(t?.files),a=0;return e=e.filter((e=>"deeplink"===e.type)),a=e.length,e=e.filter((e=>e)),a!==e.length&&(r?.errorToTelemetry?.(`toDeepLinks::Files contains falsy value. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),a=e.length),e=e.filter((e=>e.id)),a!==e.length&&r?.errorToTelemetry?.(`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),e.map((({id:e,title:t,fileInfo:n,channelId:r,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:r||i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return r?.errorToTelemetry?.(`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),null}},pe=e=>e&&JSON.stringify((0,E.map)(e,(({content:e,...t})=>({...t,content:JSON.parse(e)})))),ue=(e,t,n,i)=>{const r=i||!!e?.urlpreviews;if(!e||!e.links&&!e.urlpreviews)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],i=r?JSON.parse(e.urlpreviews):JSON.parse(e.links),a=[],s=[];return i.forEach((e=>{me(e,a,t),r?ge(e,s,t):he(e,s,[...t,"blob"],n)})),{urlPreview:s.length>0?s[0]:null,embeddedLinks:a}}catch(e){return t.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},me=(e,t,n)=>{const{url:i,fileShareUrlMeta:r,title:a,description:s}=e,o=(0,D.Jf)(i,n);r&&t.push({objectUrl:o,title:a,description:s,fileShareUrlMeta:r})},he=(e,t,n,i)=>{const{url:r,preview:a,previewenabled:s}=e,{previewurl:o,previewmeta:l,title:d,description:c}=a||{},p=(0,D.Jf)(r,n,i);t.push({url:p,thumbnail:(0,D.Jf)(o,n,i),title:d,description:c,previewEnabled:s,thumbnailMeta:l?{width:l.width,height:l.height}:null})},ge=(e,t,n)=>{const{url:i="",title:r,description:a,thumbnail:s="",thumbnail_meta:o}=e.value||{},l=(0,D.Jf)(i,n);t.push({url:l,thumbnail:(0,D.Jf)(s,n),title:r,description:a,previewEnabled:!!s,thumbnailMeta:o?{width:o.width||0,height:o.height||0}:null})},fe=(e,t,n,i)=>{let r=i&&i.policyViolation;const a=i&&i.genericStreamMetadata;if(!r&&!a)return null;const s={};if("string"==typeof r)try{r=JSON.parse(r)}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}r&&(s.policyViolation=r);let o=a&&a.policyTip;if("string"==typeof a)try{o=JSON.parse(a).policyTip}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}if(o){const e=i&&i.subject;s.dlpData={id:t,content:n,policyTip:o,subject:e}}return s},Ee=e=>{if(!e.scheduledmeetinginfo||(0,E.isNil)(e.scheduledmeetinginfo.eventType))return null;const{iCalUid:t,...n}=e.scheduledmeetinginfo;return{iCalUID:t,...n}},ye=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:r,location:a,itemid:s,meetingtitle:o,rsvpTo:l,body:d}=e;return(e=>{const{scheduledMeetingInfo:t}=e,n=L(t);if(n.length)throw(0,O.$5)(U.Ir.DataLayerClient,U.O4.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${n.join(", ")}`);return e})({meetingActionType:e[c.rF.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:r,location:a,itemId:s,meetingTitle:o,rsvpTo:l,body:d,scheduledMeetingInfo:Ee(e)})}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${t}`),null}},Ie=(e,t,n,i)=>{const r=t||n;if(r)return r;if(i&&Y.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},Ae=(e,t)=>"-1"===e?t??"":e,Ce=(0,l.A)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),Te=(e,t)=>{if(e.length<=1)return e;const n=Ce(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},Se=(e,t,n)=>{const i=Te(e,n),r=[],a=[];return(0,E.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!w.af.isTFLOffNetworkUser(n)&&i){if(a.push(i),20===a.length)return!1;r.length<3&&r.push(e)}return!0})),{membersLimited:r,memberDisplayNamesLimited:a}},ve=(e,t,n,i,r,a,o,l,c,u,m,h)=>{if(!e?.id)return;const{id:g,messagetype:f,properties:E,callId:y,skypeguid:I,composetime:A,content:C,contentHash:T,conversationid:S,crossPostData:v}=e,_=(0,p.io)(E,e.originalarrivaltime,(0,d.Hv)({conversationLink:e.conversationLink}),n),D=_e(e,t,r,a,i,!!o,h,_),b=(0,$.UM)(t,E?.languageStamp,l?.targetLanguageCode,C,u),P=(0,$.qt)(l,b,D.translatedContent,D.translationStatus),N=V(E),M=(0,$.rl)(g,b?.code,c);return{...D,__typename:"Message",__model:e,contentHash:T,interopDeliveryState:Nt(E?.deliveryState),smsDeliveryReports:E&&E.smsDeliveryReports?E.smsDeliveryReports:null,announcement:we(E),notifications:Pt(t,E),meeting:ye(t,E),onBehalfOf:oe(E,g,t),callId:Ie(f,y,I||E&&E.skypeguid,C),skypeguid:I,composeTime:A,isCallStartedMessage:(0,s.dG)(C,f),replyPermission:E?.replyPermission??null,atpSharepointData:le(t,E),isDeletedByAdmin:E?.adminDelete||!1,conversationId:S,vivaTopicsAnnotations:N,crossPostStatus:v?(0,H.lu)(v.status):void 0,crossPostFailedChannels:v?.failedChannels,isWrittenInPreferredLanguage:!P,languageSeenBefore:M,sourceLanguageCode:b?.code??null,repliesSummary:m,parentMessageId:(0,d.gB)(e.conversationLink,D.id||"")}},_e=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:r,annotationsSummary:a,userHasStarred:s,properties:o,clientmessageid:l,version:c,prioritizeimdisplayname:p,imdisplayname:m,translation:h,conversationid:g,conversationLink:f,sendPipelineStatus:E,draftDetails:y},I,A,C,T,S=!1,v,_=!1)=>{let D=t;A&&(D=A);const b=(0,q.LA)(I,o,C),P=(0,$.eQ)(h),N="Done"===P?.translationStatus?(0,B.yT)()[0].toString():c,R=(0,$.UM)(I,o?.languageStamp),F=(0,d.A$)(y);return{id:Ae(e,l),content:D,originalArrivalTime:n,from:K(i),messageType:(0,u.h)(I,r,o),isImportant:(0,M.IA)(o?.importance),importance:(0,M.mJ)(o?.importance),emotionsSummary:ae(e,a),emotions:re(o,e,a,S),mentions:se(o,e,I),cards:b,files:(0,q.Fx)(I,o),deeplinks:ce(I,o,e,g||f),...ue(o,I,v,_),deleteTime:o?.deletetime,editTime:o?.edittime,scheduledSendTime:F?new Date(F).toISOString():null,draftId:o?.draftId||(F?e:null),version:N,userHasSaved:s,renamedDisplayName:p?m:null,imDisplayName:m,clientMessageId:l,dlpContext:fe(I,e,t,o),atpSharepointData:le(I,o),status:T||"Delivered",hardDeleteReason:o?.hardDeleteReason,hardDeleteTime:o?.hardDeleteTime,onBehalfOf:oe(o,e,I),sourceLanguageCode:R?.code??null,...P,sendPipelineStatus:E}};function De(e,t){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,importance:null,mentions:null,clientMessageId:e,isSystemMessage:!1,isStreamOngoing:!1,canShowEveryoneMentionBadge:!1,formattedArrivalTime:null,hasMention:null,blurhash:null}}function be(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,F.sN)()}}function Pe(e){const t=new Date,n=t.toISOString();return{__typename:"Conversation",id:e,activeCall:null,ariaLabelledBy:null,arrivalTimeAriaLabel:null,avatarUrl:null,cfet:!1,chatHistoryHiddenTime:null,clearHistoryTime:null,clientArrivalTime:null,creator:null,extendedDirectoryRedemptionRequired:null,guardianChatInfo:null,hasFederatedUser:!1,hasGuestUser:!1,hasMissedCall:null,hasMissedMention:null,hasMissedReaction:null,hasTflConsumerUser:!1,hasTflSmsUser:null,hasTflSmsVerifiedUser:!1,hasTypingUsers:null,hasUnknownEnterpriseUser:!1,interopConversationStatus:null,isBotBlocked:null,isBotMember:null,isDisabled:!1,isExternal:null,isFederated:!1,isHidden:null,isMeeting:!1,isMuted:null,isOneOnOne:!1,isOneOnOneBotChat:!1,isPhonelinkSmsChat:null,isRead:!0,isSfB:!1,isSmsOnly:null,isTFWSmsChat:null,isUserMember:!0,lastContentMessageTime:null,lastMessage:De(t.getTime().toString(),n),lastUpdate:null,localClientId:null,me:null,meetingChatType:null,memberCount:null,membersLimited:[],oneOnOneOtherMemberId:null,picture:null,quarantineCounter:null,sensitivityLabel:null,shortTitle:null,tenantId:null,tflOffNetworkUser:null,tflOffNetworkUserLength:null,title:"",userConsumptionHorizon:null}}const Ne=(e,t,n,i,r=!1,a)=>{const{annotationsSummary:s,id:o,from:l,messageType:d,properties:c,version:m,...h}=e;if(!o)return null;const g=(0,p.io)(c,h.originalArrivalTime,t,i);try{const e=V(c);return{__typename:"Message",__model:null,id:o,from:l,messageType:(0,u.h)(n,d,c),version:(0,E.isNumber)(m)?m.toString():void 0,isImportant:(0,M.IA)(c&&c.importance),importance:(0,M.mJ)(c&&c.importance),interopDeliveryState:Nt(c?.deliveryState),smsDeliveryReports:c?.smsDeliveryReports||null,emotions:re(c,o,s,r),emotionsSummary:ae(o,s),announcement:we(c),mentions:se(c,o,n),onBehalfOf:oe(c,o,n),cards:(0,q.LA)(n,c),files:(0,q.Fx)(n,c),deeplinks:ce(n,c,o,t),...ue(c,n,a,g),deleteTime:c&&c.deletetime,editTime:c&&c.edittime,isDeletedByAdmin:c&&c.adminDelete,scheduledSendTime:c?.sendAt||null,draftId:c?.draftId||null,hardDeleteTime:c&&c.hardDeleteTime,hardDeleteReason:c&&c.hardDeleteReason,status:"Delivered",dlpContext:fe(n,o,h.content,c),meeting:ye(n,c),callId:c&&c.skypeguid,sourceLanguageCode:(0,$.UM)(n,c?.languageStamp)?.code??null,vivaTopicsAnnotations:e,...h}}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{__model:null,id:o,from:l,messageType:(0,u.h)(n,d,c),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null,...h}}},Me=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),Re=(e,t,n,i)=>Fe({id:e,properties:{[c.H0.ConsumptionHorizon]:v(i)},threadProperties:n,type:t}),Fe=e=>({id:e.id,...Me(S(e))}),we=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e?.cards)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const r=Oe(i);return{title:e.title?e.title:"",originalImageUrl:r.originalImageUrl,croppedImageUrl:r.croppedImageUrl,colorTheme:r.colorTheme,croppedImageHeight:r.croppedImageHeight,croppedImageWidth:r.croppedImageWidth,croppedImageAltText:r.croppedImageAltText,isTeamsIllustration:r.isTeamsIllustration}},Oe=e=>{let t=(0,E.get)(e,"content.imageData.origImage.src",null),n=(0,E.get)(e,"content.imageData.croppedImage.src",null);const i=(0,E.get)(e,"content.imageData.croppedImage.imageHeight",null),r=(0,E.get)(e,"content.imageData.croppedImage.imageWidth",null),a=(0,E.get)(e,"content.imageData.croppedImage.imageAltText",null),s=(0,E.get)(e,"content.imageData.isTeamsIllustration",null);let o=(0,E.get)(e,"content.imageData.colorTheme",null)||(0,E.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,o=void 0===o?null:o,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:r,croppedImageAltText:a,colorTheme:o,isTeamsIllustration:s}},Ue=(e,t,n)=>{try{const n=Le(t),i=n?.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>e?.channelData?.id&&e?.channelData?.utcTime)).map((e=>{const n={targetMessageId:e?.channelData?.targetMessageId||t.replyToId,type:e?.channelData?.type||"reply"};return{suggestionChannelData:{...e?.channelData,...n},value:e.value||e.title,title:e.title,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},Le=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>e?.type===c.jQ&&e?.from?.id===c.OD&&e?.timestamp&&e?.suggestedActions?.actions?.some((e=>e.type===c.m8||e.type===c.Wg))));return t&&0!==t.length?t:null},ke=e=>{switch(e){case m.Wf.None:return"Unknown";case m.Wf.Adhoc:return"Adhoc";case m.Wf.Scheduled:return"Scheduled";case m.Wf.Recurring:return"Recurring";case m.Wf.Broadcast:return"Broadcast";case m.Wf.MeetNow:return"MeetNow"}},Ge=e=>{if(!e)return null;const t=[];return e?.forEach((e=>{e.messageVisibilityTime&&t.push({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})})),t};function xe(e,t){if(!e||!t)return!1;return(0,h.CF)(e,t,!t.get(i.w.Messaging).disableIgnoreRetentionHorizon)>0}function Be(e,t,n,i,r,a=!1,s=!1,o,l,c=!1){const p=(0,q.vu)(e,n),u=e.find((({id:e})=>e===t))||null,m=ht(e),h=(0,d.Yo)(e,r,[],o).members||[];return{memberIds:h.map((({id:e})=>e)),...Se(h,t,i),...$e(p),...Qe(t,h),me:u,isUserMember:!!u,tflOffNetworkUser:(0,E.first)(m),tflOffNetworkUserLength:m.length,hasBotMember:h.some((({id:e})=>(0,d.Iz)(e))),hasFederatedUser:!!p.length||a,hasTflConsumerUser:We(h)||s,hasEnterpriseUser:Je(h),hasUnknownEnterpriseUser:ze(h),hasUnknownConsumerUser:qe(h),hasUnresolvedFederatedUser:p.some(w.af.isUnknownUser),hasTflSmsUnverifiedUser:He(h),hasTflSmsVerifiedUser:Ve(h),isRetentionHorizonSet:xe(l,o),hasExtendedDirectoryUsers:Mt(h),pendingBots:Rt(l),hasGuestUser:c}}const $e=e=>{const t=e.filter((e=>!w.af.isUnknownUser(e)&&e.featureSettings?.coExistenceMode!==o.bi.TeamsOnly&&!!e.displayName));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},He=e=>e.some((({id:e})=>(0,d.gZ)(e))),We=e=>e.some((e=>w.af.isTFLConsumerUser(e))),Ve=e=>e.some((e=>w.af.isTFLSmsVerifiedMri(e?.id))),qe=e=>e.some((e=>(0,d.W4)(e.id)&&w.af.isUnknownUser(e))),ze=e=>e.some((e=>w.af.isEnterpriseUserMri(e.id)&&w.af.isUnknownUser(e))),Je=e=>e.some((e=>w.af.isEnterpriseUserMri(e.id))),Qe=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&!(0,d.oG)(t.id,c.LE)&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},je={opted_out:"OptedOut",claimed:"Claimed",deprovisioned:"Deprovisioned"},Ke=e=>{if(!e)return;const t=(0,b.j)(e);return{newlyCreatedUserId:t.userId,code:je[t.code]}},Ye=e=>{if(e)return(0,P.K)()("Importing","Completed").find((t=>t===e))},Xe=(e,t)=>({...t,preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__model:e||null,__typename:"LastMessage"}),Ze=e=>e?`${e}`:null,et=({id:e,members:t,consumptionHorizon:n,userConsumptionHorizon:i,lastMessage:r,creator:a,meetingInformation:s,isDisabled:o,disabledReason:l,importState:d,isMuted:p,isLastMessageFromMe:u,isRead:m,isOneOnOne:h,isOneOnOneBotChat:g,isSticky:f,isExternal:y,consumerGroupId:I,templateType:A,chatType:C,historyHiddenTime:T,createdAt:S,interopConversationStatus:v,quickReplyAugmentation:_,meetingPolicy:D,addedBy:b,addedByTenantId:P,sensitivityLabel:N,meetingChatType:M,lastL2MessageIdNFS:w,...O},U,L,k,G,x)=>{try{const T=(0,E.map)(t,(e=>(0,R.qK)(e))),S=r&&Xe(r,Ne(r,e,U,k)),B=s&&{id:e,subject:s.subject,startTime:s.startTime,scenario:s.scenario,endTime:s.endTime,iCalUid:s.iCalUid,location:s.location,exchangeId:s.exchangeId,meetingType:s.meetingType?ke(s.meetingType):"Unknown",resolvedSensitivityLabelId:s.resolvedSensitivityLabelId,isCopyRestrictionEnforced:s.isCopyRestrictionEnforced,templateDetails:s.templateDetails,meetingJoinUrl:s.meetingJoinUrl,messagingPolicy:s.messagingPolicy,exchangeDetails:s.exchangeDetails,lobbyThreadId:s.lobbyThreadId},$=!(!h&&!f&&A!==c.iy.ImmutableRoster),H=N&&N.id?{id:N.id,isCopyBlocked:N.protectTeamsLabelAction?.isCopyRestrictionEnforced||!1}:void 0,W=Ze(w);return{__typename:"Conversation",...Be(T,G?.id||"",L,x),...O,id:e,consumptionHorizon:n&&{__typename:"ConsumptionHorizon",...Re(e,c.Cr.Chat,{lastjoinat:O.lastJoinAt},n)},consumptionHorizonBookmark:i&&{__typename:"ConsumptionHorizonBookmark",...Re(e,c.Cr.Chat,{lastjoinat:O.lastJoinAt},i)},userConsumptionHorizon:i&&{__typename:"ConsumptionHorizonBookmark",...Re(e,c.Cr.Chat,{lastjoinat:O.lastJoinAt},i)},lastL2MessageIdNotFromSelf:W,lastMessage:S,members:[],creator:a,meetingInformation:B,isDisabled:!!o,disabledReason:Ke(l),importState:Ye(d),importMetadata:(0,F.Cq)(O.importMetadata),isMuted:p,isLastMessageFromMe:!!u,isRead:m,isOneOnOne:$,cfet:y,consumerGroupId:I,isOneOnOneBotChat:!!g,chatType:st(C),interopConversationStatus:lt(v),quickReplyAugmentation:_&&Ue(e,_,U),addedBy:b,addedByTenantId:P,meetingChatPolicy:ct(D),sensitivityLabel:H,meetingChatType:ut(M)}}catch(t){U.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{...O,id:e,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:T,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,importMetadata:null,chatType:null}}},tt=({id:e,members:t,tenantId:n,meetingInformation:i},r)=>{try{const r=(0,E.map)(t,(e=>(0,R.qK)(e)));return{__typename:"ConversationMembers",id:e,tenantId:n=n??"",meetingJoinUrl:i?.meetingJoinUrl??"",members:r}}catch(t){r.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},nt=(e,t,n,i,r,a)=>({node:et(e,t,n,i,r,a),cursor:e.createdAt||e.id});function it(e){return JSON.stringify((0,E.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":J,itemid:e.itemId,mri:e.userId,appId:e.appId,mentionType:t,displayName:n}})))}function rt(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const t=e.mentionType,n=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const at=new Map([["chat","Chat"],["phonechat","PhoneChat"],["phonelink1on1chat","Phonelink1on1Chat"],["phonelinkgroupchat","PhonelinkGroupChat"],["meeting","Meeting"],["sfbinteropchat","SfBInteropChat"]]),st=e=>{let t=null;return null==e||(t=at.get(e),void 0===t&&(t=null)),t},ot=new Map([["AcceptPending","AcceptPending"],["ExtendedDirectoryAcceptPending","ExtendedDirectoryAcceptPending"],["Accepted","Accepted"],["Blocked","Blocked"],["Quarantined","Quarantined"],["AcceptPendingRecipient","AcceptPending"]]),lt=e=>e&&ot.get(e)||null,dt=new Map([["ChatEnabled","ChatEnabled"],["ChatDisabled","ChatDisabled"],["InMeeting","InMeeting"],["ChatEnabledAnonymousDisabled","ChatEnabledAnonymousDisabled"],["InMeetingAnonymousDisabled","InMeetingAnonymousDisabled"],["InMeetingRestrictOrganizer","InMeetingRestrictOrganizer"],["InMeetingAnonymousDisabledRestrictOrganizer","InMeetingAnonymousDisabledRestrictOrganizer"]]),ct=e=>e&&dt.get(e)||null,pt=new Map([["backroom","Backroom"],["lobby","Lobby"]]),ut=e=>e&&pt.get(e)||null,mt=e=>!!e&&"PhoneChat"===e,ht=e=>e.filter((e=>w.af.isTFLOffNetworkUser(e.id))),gt=e=>{let t;switch(e){case g.rI.Error:t="Error";break;case g.rI.Sending:t="Sending";break;case g.rI.Retrying:t="Retrying";break;default:t="Delivered"}return t},ft=e=>(0,f.t0)(e)||(0,d.oZ)(e)||(0,h.xl)(e),Et=(e,t)=>(0,E.filter)(e,(0,E.omit)(t,"__typename")),yt=e=>!!e&&-1!==e.indexOf(X),It=e=>!!e?.startsWith("tfl:preview-"),At=e=>!!e&&(-1!==e.indexOf(c.iB)||-1!==e.indexOf(c.hd)),Ct=e=>e===Z,Tt=e=>"AcceptPending"===e,St=e=>Ct(e)||yt(e),vt=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),_t=e=>!!e&&e.includes("meeting"),Dt=(e,t,n,i,a,s,o,l,d)=>{if(!e)return;const c="Phonelink1on1Chat"===t,p="PhonelinkGroupChat"===t,u=n?r.bF.Meeting:i?a?r.bF.Botchat:mt(t)?r.bF.SMSOneOnOneChat:(0,h.xl)(e)?r.bF.SfcInteropChat:(0,f.t0)(e)?r.bF.SfbInteropChat:s?r.bF.NativeFederatedChat:o?r.bF.FederatedChat:(0,h.qL)(e)&&c?r.bF.Phonelink1on1Chat:r.bF.OneOnOneChat:(0,h.L5)(e)?r.bF.StreamOfNotes:(0,h.qL)(e)&&p?r.bF.PhonelinkGroupChat:d||(e=>!!e&&e===m.vW.Channel)(l)?r.bF.Channel:r.bF.GroupChat;return u},bt=e=>{if((0,E.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,E.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},Pt=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>({surface:e,contentType:t,content:{value:{height:bt(n.value?.height)??void 0,width:bt(n.value?.width)??void 0,title:n.value?.title??"",url:n.value?.url??""},actions:n.actions??[]}})))}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${t}`),null}};function Nt(e){if(e)return"string"==typeof e?e:e.state}const Mt=e=>e.some((e=>w.af.isExtendedDirectoryUser(e))),Rt=e=>{if(e&&yt(e.id)){const t=e.properties.pendingBotMembers;if(t){return(0,b.j)(t)}}},Ft=e=>{const t=e.split(";");return{conversationId:t[0],replyChainId:t.find((e=>e.startsWith("replyChainId=")))?.split("=")[1]||null,messageId:t.find((e=>e.startsWith("messageId=")))?.split("=")[1]||null}},wt=e=>{const{replyChainId:t}=Ft(e.id||"");return e.type===a.ck.chats&&!!t}},378044:(e,t,n)=>{n.d(t,{LA:()=>l,Fx:()=>u,vu:()=>m});var i=n(364819),r=n(348103),a=n(539299),s=n(355515),o=n(34655);const l=(e,t,n)=>{if(!t||!t.cards||"string"!=typeof t.cards&&!n)return null;try{let e=String(t.cards);n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:r,contentType:a,locale:s,userSpecificContent:o})=>({appIcon:e,appId:t||"",appName:n,cardClientId:i,content:JSON.stringify(r),contentType:a,locale:s,...!!o&&{userSpecificContent:o}})))}catch(t){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}};var d;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(d||(d={}));const c=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const n=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(t.code);return{code:n,type:(e=>{switch(e){case d.Sharepoint:return"Sharepoint";case d.WOPI:return"WOPI";case d.Google:return"Google";case d.OneDrive:return"OneDrive";case d.Recent:return"Recent";case d.Aggregate:return"Aggregate";case d.FileSystem:return"FileSystem";case d.Search:return"Search";case d.AllFiles:return"AllFiles";case d.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}})(parseInt(t.type,10))}}catch(e){return void t.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},p=(e,t)=>{{const n=2,l=["http","https"],{filePreview:d,chicletBreadcrumbs:p,fileInfo:u,anchorFileId:m,progressComplete:h,isUploadError:g,fileChicletState:f,providerData:E}=e,{shareUrl:y,shareId:I,itemId:A}=u,C=(e=>{if(!e)return{};const t=e=>void 0!==e&&(0,i.isNumber)(e)&&isFinite(e)?Math.min(Math.max(e,0),2147483647):void 0,{previewUrl:n,previewHeight:r,previewWidth:a}=e;return{previewUrl:n,previewHeight:t(r),previewWidth:t(a)}})(d),T=f?.serviceName,{id:S,baseUrl:v,objectUrl:_,type:D,title:b,state:P}=((e,t)=>{const{version:n}=e;let{id:i,baseUrl:r,objectUrl:a,type:l,title:d,state:c}=e;if(n!==t&&(({itemid:i,fileName:d,fileType:l,fileInfo:{fileUrl:a,siteUrl:r}}=e),c=e.fileChicletState?.state),"string"!=typeof i)throw(0,s.$5)("ChatHelpers",o.O4.Undefined,"toFiles",{id:i,version:n,type:l},"File id is missing");return{id:i,baseUrl:r,objectUrl:a,type:l,title:d,state:c}})(e,n),N="active"!==P&&"hidden"!==P,M=c(E,t),R=(0,r.K)()("aggregatefiles","customspo","downloads","p2p","personal","recent","teams","teamsSdk","skype"),F=(0,r.K)()("active","deleted","reference","hidden");return{id:S,itemId:A,chicletBreadcrumbs:p,baseUrl:(0,a.Jf)(v,l),objectUrl:(0,a.Jf)(_,l),shareId:I,shareUrl:y,type:D,title:b,fileId:S,isReferencedFile:N,anchorFileId:m,progressComplete:h&&parseInt(h,10)||null,serviceName:T&&R.find((e=>e===T)),state:P&&F.find((e=>e===P)),hasUploadFailed:g,providerDataV2:M,...C}}},u=(e,t)=>{if(!t||!t.files||"string"!=typeof t.files)return null;try{let n=JSON.parse(t.files);n=n.filter((e=>"deeplink"!==e.type));return(0,i.map)(n,(t=>p(t,e)))}catch(e){return null}},m=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t))},325759:(e,t,n)=>{n.d(t,{Pf:()=>l,sN:()=>d,ZI:()=>c,Cq:()=>u});var i=n(364819),r=n(244698),a=n(355515),s=n(34655),o=n(194649);const l=(e,t,n)=>{let r=[];if((0,i.isEmpty)(e)||(0,i.isEmpty)(t)){const i=`Invalid user ids when generating chat id from members: userId1=${e}, userId2=${t}`;throw n.error(i),(0,a.$5)(i,s.O4.InvalidInput,"chatIdFromMembers")}r=(0,o.Iz)(e)&&!(0,o.Iz)(t)?[(0,o.m9)(t),(0,o.m9)(e)]:!(0,o.Iz)(e)&&(0,o.Iz)(t)?[(0,o.m9)(e),(0,o.m9)(t)]:[(0,o.m9)(e),(0,o.m9)(t)].sort();const l=(0,o.Xb)(e),d=(0,o.Xb)(t);if(l||d){if(l===d)return`19:${l}:${r[0]}_${r[1]}@unq.gbl.spaces`;n.warn(`Both users are in different clouds: ${l} and ${d}. This should be a federated chat, falling back to default chat ID generation.`)}return`19:${r[0]}_${r[1]}@unq.gbl.spaces`};function d(){const[e,t]=(0,r.yT)(2);return`${e}${t}`.substr(0,19)}const c=e=>void 0!==e?.pinnedTime&&e.pinnedTime>0,p=new Map([["Importing","IMPORTING"],["Completed","COMPLETED"],["RosterRestricted","ROSTER_RESTRICTED"],["None","NONE"]]),u=e=>{var t;if(e)return{importState:(t=e.importState,p.get(t)??"NONE")}}},271126:(e,t,n)=>{var i,r;n.d(t,{aY:()=>r,IA:()=>a,zS:()=>s,mJ:()=>o}),function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(i||(i={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(r||(r={}));const a=e=>"Important"===o(e),s=e=>r[e]||r.Standard,o=e=>{switch(e){case r.Important:case i.Important:return"Important";case r.Urgent:case i.Urgent:return"Urgent";case r.Standard:case i.Standard:default:return"Standard"}}},438543:(e,t,n)=>{n.d(t,{wJ:()=>l,KN:()=>c,bX:()=>p,W3:()=>h,fj:()=>g,UM:()=>f,qt:()=>y,eQ:()=>A,rl:()=>C});var i,r=n(136723),a=n(554186),s=n(75914),o=n(514188);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(i||(i={}));const l=new RegExp("https?://[^\\s]+","i"),d="-",c=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let t=e.indexOf(d,1);if(-1===t)return e;let n=e.indexOf(d,t+1);return-1===n&&(n=e.length),n-t==5&&(t=n),e.substring(0,t)},p=e=>{const t=e?c(e):"",n=(0,r.get)("tcurlang")||t;return{targetLanguage:n,knownLanguages:[n]}},u=(e,t)=>(e=>{switch(e){case s.Uf.Success:return"Done";case s.Uf.MessageNotFound:return"MessageNotFound";case s.Uf.VersionNotFound:return"VersionNotFound";case s.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case s.Uf.SkipTranslation:case s.Uf.ContentIsEmpty:return"TranslationNotNeeded";default:return"UnknownError"}})(((e,t)=>{const n=s.Uf[e];return void 0!==n?n:(t?.error(`Unable to parse translation result code: ${e}`),s.Uf.UnknownError)})(e,t)),m=async(e,t,n,i,r,a,o,l,d)=>{try{return await e.translateMessages(t,n,i,r,a,o,d)}catch(e){return l.error(`Failed to translate ${o}: ${e}`),a.map((({id:e,version:t})=>({id:e,version:t||"",detectedLanguage:{languageId:"",score:0},resultCode:s.Uf[s.Uf.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}},h=async(e,t,n,i,r,s,o)=>{const{targetLanguage:l,knownLanguages:d}=n,c=(0,a.v4)(),p=r.map((({messageId:e,version:t})=>t?{id:e,version:t}:{id:e}));return{convId:i,targetLangCode:l,correlationId:c,translations:(await m(e,i,t,l,d,p,c,s,o)).map((e=>({messageId:e.id,content:e.translatedContent||"",sourceLangCode:e.detectedLanguage?.languageId||"",resultCode:u(e.resultCode,s),version:e.version})))}},g=async(e,t,n)=>{try{return(await e.getSupportedTranslationLanguages(t)).map((({languageTag:e,languageName:t})=>({languageCode:e,languageName:t})))}catch(e){return n.error(`Unable to retrieve languages: ${e}`),[]}},f=(e,t,n,r,a)=>{if("string"!=typeof t)return null;try{const e=(0,o.J)(t),s=e.languages?.split(";")?.map((e=>{const[t,n]=e.split(":");return{code:t,score:parseInt(n,10)}})),l=s[0].code;if("null"===l)return null;let d=s.length;d>0&&""===s[d-1].code&&(s.pop(),d--);const c=void 0!==e.length,p=d>0&&"length"===s[d-1].code;if(!(c||p))return{code:l,confidenceLevel:i.LOW};const u=JSON.parse(a??"{}").settingsData,m=u?.find((t=>t.detector===e.detector));if(!(m&&n&&r&&m.minConfidence))return{code:l,confidenceLevel:i.LOW};const h=((e,t)=>{const n=e.minCharMap,i=e.minCharMapOverrides,r=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return i?.[t]??n?.[r.get(t)??""]??n?.others??5})(m,l),g=m.minConfidence??70,f=s.find((e=>e.code===n))?.score;if(n!==l){let t=0;if(c&&(t=parseInt(e.length,10)||0),p&&(t=E(s)),t<h)return{code:l,confidenceLevel:i.LOW};if(f&&f>=g)return{code:n,confidenceLevel:i.LOW}}return{code:l,confidenceLevel:i.HIGH}}catch(n){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${t}.`),null}},E=e=>{const t=e.pop();return t?.score||0},y=(e,t,n,r)=>{const a=t?.code;if(!e||!a||t?.confidenceLevel===i.LOW)return!1;const s=e.knownLanguages;if(a===e.targetLanguageCode||s.includes(a))return!1;switch(e.translationMode){case"SUGGEST_TRANSLATION":return!0;case"ALWAYS_TRANSLATE":if(n&&"ShowOriginalMessage"===r)return!0}return!1},I=(e,t)=>{if(!e)return"ShowOriginalMessage";if(!t)return"Done";switch(t){case s.Uf.Success:return"Done";case s.Uf.SkipTranslation:return"TranslationNotNeeded";case s.Uf.MessageNotFound:return"MessageNotFound";case s.Uf.VersionNotFound:return"VersionNotFound";case s.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case s.Uf.UnsupportedSourceLanguage:return"UnsupportedSourceLanguage";default:return"UnknownError"}},A=e=>{const{body:t,subject:n,title:i,toggled:r,detectedLanguageName:a,sourceLanguageCode:s,targetLanguageCode:o,isOnDemandTranslation:l,isInProgress:d,error:c}=e||{};if(d)return{translationStatus:"InProcess"};return(void 0!==t||void 0!==c)&&a&&s&&o?{translationStatus:I(!!r,c),translatedSubject:n,translatedContent:t,translatedTitle:i,isOnDemandTranslation:l,sourceLanguageName:a,sourceLanguageCode:s}:void 0},C=(e,t,n)=>{if(!n)return!1;let i=null;return n&&(i=n.find((e=>e.languageCode===t))),!(!i||i.messageId===e)}},785053:(e,t,n)=>{n.d(t,{qK:()=>d,N4:()=>c,p_:()=>E});var i=n(210071),r=n(586892),a=n(771330),s=n(97882),o=n(194649),l=n(364819);const d=(e,t,n,i)=>{const a=r.af.getRequestCount(e),{accountEnabled:s,mri:o,objectId:l,displayName:d,givenName:c,surname:g,type:E,consumerProfileType:I,jobTitle:A,userPrincipalName:C,email:T,tenantId:S,sipProxyAddress:v,mobile:_,telephoneNumber:D,tenantName:b,decoratedDisplayName:P,cid:N,description:M,externalCalendarEmailAddress:R,homeMri:F,homeTenantId:w,mtoLabel:O,profileType:U,avatarETag:L,avatarUrl:k,searchableByProfile:G,riskScore:x}=e,B={__typename:"User",accountEnabled:s,id:y(e),objectId:l,mri:o,displayName:d,givenName:c,surname:g,type:E,consumerProfileType:I,jobTitle:A,userPrincipalName:C,email:T,tenantId:n||S||null,sipProxyAddress:v,mobile:_,telephoneNumber:D,requestCount:a,preferredUserName:t,tenantName:b||null,decoratedDisplayName:P||null,cid:N,description:M,externalCalendarEmailAddress:R,emailForQuery:i,homeMri:F,homeTenantId:w,mtoLabel:O,profileType:U,avatarETag:L,avatarUrl:k,searchableByProfile:G,riskScore:x};return function(e,t){const n=e.department;n&&(t.department=n)}(e,B),h(e,B),m(e,B),p(e,B),u(e,B),f(B),B},c=e=>{const{id:t,displayName:n,description:i,email:r,phone:a,mri:s,requestCount:o,syncSource:l}=e;return{__typename:"User",id:t,mri:s,objectId:s,displayName:n,userPrincipalName:s,givenName:n,surname:n,description:i,email:r,mobile:a,telephoneNumber:a,requestCount:o,syncSource:l}},p=(e,t)=>{if(function(e){const t=e;return void 0!==t.isFederated||void 0!==t.isAnonymousB2bUser||"federated"===t.type?.toLowerCase()}(e)){const{isFederated:n,fetchErrorCode:i,isAnonymousB2bUser:s}=e;t.isFederated=n||"federated"===e.type?.toLowerCase(),t.fetchErrorCode=i,t.isAnonymousB2bUser=s,e.trustReason===a.Ed.SharedChannelXTAPEnabled?t.trustworthy=r.af.getFamiliarTrustworthy("SHARED_CHANNEL"):e.trustReason===a.Ed.HighTrustFederation&&(t.trustworthy=r.af.getFamiliarTrustworthy("FEDERATED"))}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},u=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,l.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,l.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(t.avatarUrl=e.avatarUrl),t.isShortProfile=e.isShortProfile},m=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.Pk.botType:(0,o.Iz)(e.mri)}(e)||function(e){return"aduser"===e.type?.toLowerCase()||"aduser"===e.$$subType?.toLowerCase()}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},h=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>g(e))))},g=e=>({number:e.number,type:e.type}),f=e=>{const{mri:t}=e;if((0,s.Ku)(t)&&!e.displayName){const n=(0,s.IK)(t);e.displayName=n,e.givenName=n}else if(t&&(0,o.gZ)(t)&&!e.displayName){const n=(0,o.eu)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},E=e=>!!e&&!("string"!=typeof e||!r.af.isTFLSmsVerifiedMri(e)),y=e=>e.mri||e.objectId||e.concatenatedId},432380:(e,t,n)=>{n.d(t,{W:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("query ServicesIoDataSimpleCollabSettingsQuery {userPreferencesForSimpleCollab {simpleCollabUserSettings {id,hasUserEnabledAdaptiveRailForDesktop,hasUserEnabledUnifiedAppForDesktop,hasUserEnabledMessagePreviews,hasUserEnabledShowTimeStamps,firstTimeOptedInAt,hasUserVisitedSettings,hasUserEnabledMessagePreviewsForSplitApp,hasUserEnabledShowTimeStampsForSplitApp}}}");return delete this.definitions,this.definitions=e.definitions}}},355552:(e,t,n)=>{n.d(t,{jr:()=>i,gM:()=>r,UB:()=>a,IN:()=>s,jq:()=>o,m7:()=>l,RS:()=>d,H$:()=>c,_N:()=>p,b5:()=>u,DU:()=>m,iV:()=>h,DP:()=>g,_e:()=>f,zK:()=>E,c3:()=>y,Pq:()=>I,Zw:()=>A,RX:()=>C,H:()=>T,ew:()=>S,Wg:()=>F,ez:()=>w,d9:()=>O,qf:()=>U,Gh:()=>L,RJ:()=>k,FG:()=>G,A1:()=>x,L2:()=>B,IT:()=>$});const i={Team:"Team",Personal:"Personal",GroupChat:"GroupChat"};var r,a,s,o;!function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(r||(r={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(a||(a={})),function(e){e.AppDefinition="AppDefinition",e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(s||(s={})),function(e){e.UserAppPin="UserAppPin",e.TenantAppPolicyChange="TenantAppPolicyChange"}(o||(o={}));const l={Tab:"Tab",Bot:"Bot",Messaging:"Messaging",Connector:"Connector",StaticTab:"StaticTab",CUSTOMBOT:"CUSTOMBOT"};var d;!function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced",e.Mutated="Mutated",e.HashUpdate="HashUpdate"}(d||(d={}));const c={Unknown:"Unknown",SidePanel:"SidePanel",Stage:"Stage"};var p;!function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(p||(p={}));const u={Unknown:"Unknown",PersonalTab:"PersonalTab",ChannelTab:"ChannelTab",PrivateChatTab:"PrivateChatTab",MeetingChatTab:"MeetingChatTab",MeetingDetailsTab:"MeetingDetailsTab",MeetingSidePanel:"MeetingSidePanel",MeetingStage:"MeetingStage",TeamLevelApp:"TeamLevelApp"};var m,h,g;!function(e){e.Application="Application",e.Delegated="Delegated"}(m||(m={})),function(e){e.Unknown="Unknown",e.Enabled="Enabled",e.Disabled="Disabled"}(h||(h={})),function(e){e.BotBased="botBased",e.ApiBased="apiBased"}(g||(g={}));const f={MRU:"MRU",AlphabeticalAsc:"AlphabeticalAsc",AlphabeticalDesc:"AlphabeticalDesc"};var E,y,I,A,C,T;!function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(E||(E={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(y||(y={})),function(e){e.User="User",e.AzureAdApp="AzureAdApp"}(I||(I={})),function(e){e.DeepLink="DeepLink"}(A||(A={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(C||(C={})),function(e){e.Federation="Federation"}(T||(T={}));const S={Unknown:"Unknown",TeamsApp:"TeamsApp",TaosSharedApp:"TaosSharedApp"};var v,_,D,b,P,N,M,R,F,w,O,U,L,k,G,x,B,$;!function(e){e.Mail="mail"}(v||(v={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(_||(_={})),function(e){e.General="general"}(D||(D={})),function(e){e.Short="short",e.Long="long"}(b||(b={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee",e.OnlineMeetingDetailsOrganizer="onlineMeetingDetailsOrganizer",e.LogEventMeetingDetailsAttendee="logEventMeetingDetailsAttendee",e.Default="default"}(P||(P={})),function(e){e.After="after",e.Before="before"}(N||(N={})),function(e){e.Button="button",e.Menu="menu"}(M||(M={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(R||(R={})),function(e){e.Bot="bot"}(F||(F={})),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra",e.OAuth2_0="oAuth2.0"}(w||(w={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings",e.Copilot="Copilot"}(O||(O={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(U||(U={})),function(e){e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.NotInstalled="NotInstalled",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(L||(L={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition",e.OpenAiPlugins="OpenAiPlugins"}(k||(k={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(G||(G={})),function(e){e.chats="chats",e.channels="channels",e.channelMeetings="meetings"}(x||(x={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned",e.AdminPrepinned="AdminPrepinned"}(B||(B={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}($||($={}))},576171:(e,t,n)=>{n.d(t,{Jy:()=>z,Ph:()=>u,rf:()=>m,CA:()=>w,IB:()=>V,FV:()=>q,oB:()=>x,BV:()=>F,IG:()=>B,_5:()=>O,oQ:()=>H,Ns:()=>G,qX:()=>P,y$:()=>y,aY:()=>f,Wq:()=>S,$b:()=>g,vQ:()=>b,GW:()=>M,n2:()=>R,RY:()=>Q,CR:()=>U,j7:()=>L,Cy:()=>N,oI:()=>h,Z:()=>v,FF:()=>_,t0:()=>D,SL:()=>W,nK:()=>T,kO:()=>k,cR:()=>$,tH:()=>I});var i=n(332752),r=n(46377),a=n(886185),s=n(364819),o=n(821296),l=n(194649),d=n(933370);var c=n(75914);var p=n(596497);const u=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:n,quarantineCounter:a,creator:s,currentUserMri:o},l)=>{let d=r.$y.Accepted;if(e){if(t){const e=s===o,{maxInviteFreeQuarantineCounter:t}=l.get(i.w.People),c=a>=(t||0);n&&!e?d=r.$y.AcceptPending:e&&c&&(d=r.$y.Quarantined)}}else d=r.$y.Blocked;return d},m=(e,t)=>e===r.j5.Accept?r.$y.Accepted:e===r.j5.Block?r.$y.Blocked:e===r.j5.Unblock&&t?r.$y.Accepted:r.$y.AcceptPending,h=e=>!!e?.startsWith(r.gN.PhonelinkSmsPrefix),g=e=>!!e?.endsWith(r.FG),f=(e,t)=>y(e.id,t)&&S(e,t)&&!E(e,t),E=(e,t)=>{const{enableMessagingGoldenGateCSV1:n}=t.get(i.w.Messaging);return!(!n||!(0,p.tK)(e.id)||"true"!==e?.properties?.conversationblocked?.toString().toLowerCase()&&e?.properties?.interopconversationstatus!==r.$y.Blocked)},y=(e,t)=>{if(!C(e))return!1;const{overrideThreadTypeForPrivateFeeds:n}=t.get(i.w.Sync);return(!(0,l.JO)(e)||!n)&&!h(e)},I=(e,t,n)=>{if(!e)return"";if((0,l.zh)(e,!0)){n.errorToTelemetry?.(`Reply chain ID found in conversation ID: ${e}. CallerInfo: ${t}`,"cdl_conversations_fetch",{reason:t,conversationId:e},!0);const{isValid:i,conversationId:r}=(0,l.my)(e);if(i)return r}return e},A=/^\d+[:]{1}.+/,C=e=>!(0,s.isUndefined)(e)&&e!==r.bY&&!h(e)&&!e.includes(r.pK)&&!e.includes(r.LH)&&!g(e)&&A.test(e),T=e=>e.startsWith(r.zD)?"MRI conv id":e,S=(e,t)=>!(_(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(i.w.Messaging),{isSfbCloud:n,isSipEnabled:r,isSfbCloudInBVD:a,isSipEnabledInBVD:s}=e.get(i.w.UserResources);return!!(t?s&&a:r&&n)}(t));function v(e){return((0,s.isString)(e)?e:e.id).endsWith(r.L)}function _(e){return((0,s.isString)(e)?e:e.id).endsWith(r.lo)}const D=e=>!!e&&_(e),b=e=>{const t=e.memberProperties?.[r.UO.RelationshipState];return!!t?.edRedemptionRequired},P=(e,t)=>{const n=e.memberProperties?.[r.UO.RelationshipState],i=!!t&&!!(0,p.tK)(e.id)&&"true"===e?.properties?.conversationblocked?.toString().toLowerCase();return!!n?.blockTime||i};const N=e=>!!e.memberProperties?.[r.UO.IsModerator],M=e=>e.threadProperties&&!!e.threadProperties[r.iy.ParentSpaces],R=e=>e.threadProperties&&e.threadProperties[r.iy.ThreadType]===a.b.Team&&M(e),F=e=>{if(e.threadProperties&&e.threadProperties?.[r.iy.ParentSpaces])try{const t=JSON.parse(e.threadProperties?.[r.iy.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},w=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,n=t?JSON.parse(t):void 0;return n?n.meetingType:void 0}catch{return}},O=(e,t,n)=>{if(t){const{enableStreamChatFeature:e,forceCommentStreamForConversations:r}=t.get(i.w.Calling);if(!e)return!1;if(n&&(r??[]).includes(n))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const t=e.toLowerCase();return"true"===t||"on"===t||"1"===t}return!1}(e.isLiveChatEnabled)},U=e=>L(e.type),L=e=>!!e&&e.toLowerCase&&e.toLowerCase()===r.Cr.Meeting.toLowerCase(),k=e=>{let t;if(U(e)&&e.threadProperties.meeting)try{const n=JSON.parse(e.threadProperties.meeting);n.subject&&(t=n.subject)}catch{return t}return t},G=e=>e===r.Go.Text||e===r.Go.RichText||e===r.Go.HTML,x=e=>!!e.members?.some((e=>(0,l.W4)(e.id))),B=e=>e.id===o.lD.CallLogConversationId||e.id===o.lD.SharedCallLogConversationId||(0,l._5)(e?.threadProperties?.threadType),$=e=>{if(e===r.uN)return!1;const t=1209600*d.om*.5;if(!e||isNaN(e))return!0;return e-Date.now()<t},H=e=>e?.threadProperties&&(e?.threadProperties[r.iy.ThreadType]===a.b.Community||e?.threadProperties[r.iy.SpaceType]===r.iy.SpaceType_Community),W=e=>e?.threadProperties&&e?.threadProperties[r.iy.ThreadType]===a.b.SubCommunity,V=e=>e.threadProperties&&e.threadProperties[r.iy.SubstrateGroupId]||"",q=e=>{const t=e.threadProperties?.[r.iy.ThreadSubType]?.toLowerCase();return t||c.jZ.Unknown},z=e=>{const t=e.threadProperties&&e.threadProperties[r.iy.ThreadType];return J(t)},J=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"},Q=e=>L(e.type)&&"lobby"===e.threadProperties?.meetingChatType?.toLowerCase()},260465:(e,t,n)=>{n.d(t,{UZ:()=>h,kp:()=>g,xL:()=>f,CT:()=>E,oy:()=>y,bI:()=>I,QD:()=>A,I_:()=>C,bJ:()=>T,kW:()=>S,lz:()=>v,xH:()=>_,GK:()=>D,Yt:()=>b,FA:()=>P,PP:()=>M,j8:()=>R,E0:()=>F,IJ:()=>w,bl:()=>O,yT:()=>U,Rt:()=>L,BA:()=>G,s8:()=>x,nX:()=>B,Z9:()=>$,r0:()=>H,pB:()=>W,lE:()=>V,as:()=>q,_Y:()=>z,tf:()=>J,DQ:()=>Q,IV:()=>j,Mn:()=>K,Zl:()=>Y,xt:()=>X,SG:()=>Z,Zp:()=>ee,mT:()=>te,Vj:()=>ne,HV:()=>ie,yW:()=>re,CF:()=>ae,ZV:()=>se,uF:()=>oe,vz:()=>le,B6:()=>de,oh:()=>ce,LK:()=>pe,Y5:()=>ue,Gw:()=>me,mz:()=>he,aJ:()=>ge,iF:()=>fe,h1:()=>Ee,NX:()=>ye,K$:()=>Ie,CN:()=>Ae,LN:()=>Ce,qL:()=>Se,je:()=>ve,mv:()=>_e,sx:()=>De,bP:()=>be,Cy:()=>Pe,wI:()=>Me,$i:()=>we,kE:()=>Oe,d2:()=>Ue,__:()=>Le,CE:()=>ke,Yp:()=>Ge,XS:()=>xe,Ce:()=>Be,rD:()=>$e,xl:()=>He,L5:()=>We,nv:()=>Ve,cQ:()=>qe,Am:()=>ze,Xv:()=>Je,UC:()=>Qe,Dt:()=>je,kA:()=>Ke,V8:()=>Ye,$T:()=>Xe,W:()=>Ze,Ps:()=>et,Vb:()=>tt,Gy:()=>nt,ZT:()=>it,WH:()=>rt,rq:()=>at,OW:()=>st,EO:()=>dt,F$:()=>ct,T4:()=>pt,MO:()=>ut,Nb:()=>mt,OK:()=>ht,n_:()=>gt,$x:()=>ft,ze:()=>Et,bX:()=>yt,Zn:()=>It,nG:()=>At,OA:()=>Ct,AJ:()=>Tt,ME:()=>St,mb:()=>vt,f9:()=>_t,S9:()=>Dt,QP:()=>bt,Bt:()=>Pt,mp:()=>Nt,XY:()=>Rt,vn:()=>Ft,Xo:()=>wt});var i=n(821296),r=n(364819),a=n(332752),s=n(194649),o=n(46377),l=n(886185),d=n(75914),c=n(576171),p=n(875880),u=n(226883),m=n(596497);var h;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(h||(h={}));const g=e=>{const t=P(e);return(0,c.FF)(e)?t:t||(0,c.t0)(e)},f=(e,t)=>{const n=e.threadProperties?.[o.iy.Creator]||null;return t&&(0,m.x_)(e.id)&&n?n.split(";")[0]:n},E=e=>e.threadProperties&&e.threadProperties[o.iy.CreatedAt]?e.threadProperties[o.iy.CreatedAt]:null,y=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[o.iy.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},I=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[o.H0.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},A=e=>e.threadProperties[o.iy.ChatModalityType]===o.L5.Conversational,C=e=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const t=le(e);return 0!==t&&(!(0,r.isNil)(e.lastMessageTimeUtc)&&t>=e.lastMessageTimeUtc)},T=e=>!(!e.properties||!e.properties[o.H0.Followed])&&"true"===e.properties[o.H0.Followed]?.toLowerCase(),S=e=>!(!e.properties||!e.properties[o.H0.Collapsed])&&"true"===e.properties[o.H0.Collapsed]?.toLowerCase(),v=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,_=e=>-1===e.detailsVersion&&-1===e.threadVersion,D=e=>v(e)||!me(e);function b(e=""){return e.includes(o.pK)||e.includes(o.LH)||e===o.bY}const P=e=>(0,s.ye)(e.id,e?.threadProperties?.threadType)&&b(e.id),N="lwgChannelLie-",M=e=>`${N}${e}`,R=e=>e.startsWith(N),F=e=>j(e)&&e.properties&&!!e.properties.isLie,w=e=>e.threadProperties&&(e.threadProperties[o.iy.ThreadType]===l.b.Team||e.threadProperties[o.iy.ThreadType]===l.b.Community)&&!(0,c.GW)(e),O=e=>!(e.threadProperties[o.iy.ParentSpaces]||!e.threadProperties[o.iy.SubstrateGroupId]||!e.threadProperties[o.iy.GroupId]||e.threadProperties[o.iy.ThreadSubType]),U=e=>w(e)&&!O(e),L=e=>ee(e)?et(e)||"":ye(e)||"";function k(e){return!!e.threadProperties&&e.threadProperties[o.iy.ThreadType]===l.b.Team}const G=e=>{if(e.properties){if(e.properties[o.H0.Favorite])return"true"===e.properties[o.H0.Favorite]?.toLowerCase();if(k(e))return!0}return!1},x=e=>!e.properties||void 0===e.properties[o.H0.GeneralChannelFavorite]||null===e.properties[o.H0.GeneralChannelFavorite]||"true"===e.properties[o.H0.GeneralChannelFavorite]?.toLowerCase(),B=e=>{const t=w(e);return t&&x(e)||!t&&G(e)},$=(e,t=!1)=>H(e.type,e.id,t),H=(e,t,n=!1)=>!(0,r.isNil)(e)&&(e.toLowerCase()===o.Cr.Thread.toLowerCase()&&(0,m.x_)(t)||e.toLowerCase()===o.Cr.Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhoneChat.toLowerCase()||e.toLowerCase()===o.Cr.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===o.Cr.OneOnOne.toLowerCase()||e.toLowerCase()===o.Cr.StreamOfNotes.toLowerCase()||!n&&(0,c.j7)(e)),W=e=>e.type===o.Cr.RCC,V=e=>e.id===i.lD.NotificationConversationId||(0,s.p3)(e?.threadProperties?.threadType),q=e=>e===i.lD.AnnotationsConversationId,z=e=>e.id===i.lD.DraftsConversationId,J=e=>Q(e.type),Q=e=>e===o.Cr.EngageCommunity,j=e=>K(e.type),K=e=>e===o.Cr.Team||e===o.Cr.Topic,Y=e=>he(e)===d.Cu.Shared,X=e=>he(e)===d.Cu.Standard,Z=e=>[o.SG,o.Vn].includes(e.id),ee=e=>(0,c.n2)(e)&&(0,c.BV)(e)&&he(e)===d.Cu.Private,te=e=>w(e)&&!!e.memberProperties&&!!e.memberProperties[o.UO.ChannelOnlyMember],ne=e=>{if(!(0,c.CR)(e))return!1;const t=(0,c.CA)(e);return!!t&&t===o.Wf.MeetNow},ie=e=>{if(!(0,c.CR)(e))return!1;const t=(0,c.CA)(e);return!!t&&t===o.Wf.Scheduled},re=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(o.kv)?o.kv+t:t),ae=(e,t,n=!1)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=t.get(a.w.Sync),r=i||Y(e)||n?e.threadProperties.retentionHorizonV2:0;return r&&isFinite(Number(r))?Number(r):0},se=(e,t)=>e?.members?.find((e=>e.id===t))?.shareHistoryTime??0,oe=e=>e?.members?.some((e=>!isNaN(Number(e.shareHistoryTime))&&0!==Number(e.shareHistoryTime)))??!1,le=e=>{if(!e.properties)return 0;if(I(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const t=$(e)?e.properties.clearHistoryTime:0;return t&&isFinite(Number(t))?Number(t):0},de=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,ce=(e,t,n)=>{const i=ae(t,n,!n.get(a.w.Sync).disableForceRetentionHorizonInSyncValidation);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},pe=(e,t)=>{const n=le(t),i=Number(e);return!isNaN(i)&&!isNaN(n)&&i<n},ue=(e,t,n=!1,i=!1)=>{if((0,s.ye)(e.id,e?.threadProperties?.threadType)&&!v(e)){if(e.memberProperties&&!(0,r.isEmpty)(e.memberProperties)&&n)return e.memberProperties[o.UO.ExpirationTime];if(e.memberProperties&&!(0,r.isEmpty)(e.memberProperties)||!n||!i){if(e.members&&t){const n=(0,r.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[o.UO.ExpirationTime]}}},me=(e,t)=>!(0,s.ye)(e.id,e?.threadProperties?.threadType)||!v(e)&&!y(e)&&((0,r.isArray)(e.members)&&t?(0,r.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&j(e)&&!e.threadProperties[o.iy.LastLeaveAt]&&!e.threadProperties[o.iy.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[o.iy.LastLeaveAt]&&(!e.threadProperties[o.iy.LastJoinAt]||e.threadProperties[o.iy.LastJoinAt]<e.threadProperties[o.iy.LastLeaveAt])));function he(e){if(!e||!j(e))return;const t=e.threadProperties[o.iy.SpaceTypes],n=t?parseInt(t,10):0,i=!!e.threadProperties[o.iy.SubstrateGroupId],r=(0,c.FV)(e);return O(e)?d.Cu.Standalone:i?r===d.jZ.PrivateChannel?d.Cu.Private:d.Cu.Shared:(n&d.QU.Private)===d.QU.Private?d.Cu.Private:d.Cu.Standard}const ge=(e,t)=>{if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=e.lastMessage?.from;if(!n)return!1;return t===(0,r.last)(n.split("/"))},fe=(e,t)=>(0,r.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),Ee=(e,t,n)=>{let i;const a=!e.members||!!e.members&&(0,r.some)(e.members,(e=>!e));if(n&&!a){const r=fe(e,t);i=P(e)&&1===r.length?n[r[0]]:n[e.id]}return i},ye=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if($(e)){const n=t?.get(a.w.Messaging).enableColonInChatTitle;let i=e.threadProperties.topic;if(i&&(n?-1!==i.indexOf("live:"):-1!==i.indexOf(":"))&&(i=void 0),!i&&(0,c.CR)(e)){const t=(0,c.kO)(e);t&&(i=t)}return i}if(k(e)&&we(e)){const t=et(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,n=e.threadProperties[o.iy.TopicThreadTopic];if(n&&n.trim())return n;if(t&&t.trim())return t;if(U(e))return"General"}}return""},Ie=(e,t=!1)=>$(e,!0)&&!We(e.id)&&!Ae(e,t),Ae=(e,t=!1)=>{const n=e.members&&e.members.length<=2;return $(e,!0)&&n&&(Pe(e)||P(e)||Fe(e)||!t&&Re(e)||Te(e))&&!e.members?.some((e=>(0,s.mD)(e.id)))},Ce=e=>Ae(e)&&e.members?.some((({id:e})=>(0,s.Iz)(e))),Te=e=>e.members&&e.members.length<=2&&Ne(e)&&(e.type===o.Cr.PhoneChat||e.threadProperties&&e.threadProperties[o.iy.ThreadType]===l.b.PhoneChat),Se=e=>(0,c.oI)(e),ve=e=>Se(e.id),_e=e=>!!e&&((0,s.Ku)(e)||(0,s.gZ)(e)||(0,s.aL)(e)||(0,s.vd)(e)),De=e=>e.type===o.Cr.PhonelinkGroupChat,be=e=>e.threadProperties?.productContext===i.z_.SFL,Pe=e=>e.type===o.Cr.Phonelink1on1Chat,Ne=e=>(0,r.some)(e.members,(e=>!!e.id&&e.id.startsWith(o.gN.Pstn))),Me=(e,t)=>{const n=e?.get(a.w.Messaging)?.enableSkypeMessagesInTFL;return!!n&&(!!t&&(be(t)||(0,m.x_)(t.id)))},Re=e=>$(e,!0)&&e.members&&2===e.members.length&&!(0,r.isNil)(e.threadProperties)&&parseInt(e.threadProperties[o.iy.CreatedAt],10)<o.If,Fe=e=>!!e.id&&e.id.indexOf(o.W0)>-1||(0,s.CM)(e.threadProperties)||!!e?.id&&(0,m.tK)(e?.id),we=e=>e.threadProperties&&e.threadProperties[o.iy.ThreadType]===l.b.Topic||ee(e)||Y(e)||(0,c.SL)(e)||F(e),Oe=e=>(0,c.t0)(e),Ue=e=>He(e&&e.id),Le=e=>Oe(e)||(e=>Ge(e))(e)||Ue(e),ke=e=>Ge(e)||(0,c.t0)(e),Ge=e=>{const t=(0,r.isString)(e)?e:e.id;return(0,r.endsWith)(t,o.L)||(0,r.endsWith)(t,o.s8)||(0,r.startsWith)(t,o.iB)},xe=e=>Ge(e)||st(e),Be=e=>Ge(e)||ot(e),$e=(e,t)=>dt(e)!==t,He=e=>!!e&&((0,r.endsWith)(e,o.wx)||(0,r.startsWith)(e,o.Rq)),We=e=>e===o.cB,Ve=e=>{const t=e.members||[];return e.members&&e.members.length<=2&&t.some((e=>e.id===o.xv))&&(be(e)||(0,m.tK)(e.id))},qe=(e,t)=>!!t.get(a.w.Messaging).hideBlockedOneOnOneChat&&Ae(e)&&((0,c.qX)(e,!!t.get(a.w.Messaging).enableMessagingGoldenGateCSV1)||e?.properties?.interopconversationstatus===o.$y.Blocked),ze=(e,t)=>{const n=(e.members||[]).some((e=>t?.includes(e.id))),i=Ae(e)&&(be(e)||(0,m.tK)(e.id));return n&&i},Je=e=>!(e.id!==o.cB||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),Qe=e=>{const t=(0,r.endsWith)(e,o.L)||(0,r.endsWith)(e,o.s8)||(0,r.startsWith)(e,o.iB),n=e.endsWith(o.lo),i=He(e);return t||n||i},je=e=>{const t=ue(e),n=t&&t<Date.now();return me(e)&&!n},Ke=e=>{if(e.threadProperties&&e.threadProperties[o.iy.Topics]){const t=e.threadProperties[o.iy.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch{return[]}}return[]},Ye=(e,t)=>{const n=Ke(e);for(const e of n)if(e.id===t)return e.isShared??!1;return!1},Xe=(e,t)=>{const n=Ke(e);for(const e of n)if(e.id===t)return e.archivalLevel?.trim().toLowerCase()},Ze=e=>!!e?.some((e=>(0,s.Iz)(e))),et=e=>{if(e.threadProperties){if(e.threadProperties[o.iy.XTeamName])return e.threadProperties[o.iy.XTeamName];if(e.type===o.Cr.Team&&e.threadProperties.topic)return e.threadProperties.topic}},tt=e=>{const t=Ke(e),n=et(e);return t.map((t=>{const i={},r=t.name;return i[o.iy.CreatedAt]=parseInt(t.createdat,10),i[o.iy.Picture]=t.picture,i[o.iy.IsDeleted]=t.isdeleted,i[o.iy.XTeamName]=t.isShared?r:n,i.topic=r,i[o.iy.TopicThreadTopic]=r,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:o.Cr.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},nt=e=>{if(e.parentId)return e.parentId;if((0,c.GW)(e))try{const t=JSON.parse(e.threadProperties[o.iy.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,r.isEmpty)(n))return n}catch{return}},it=e=>{const t=e.threadProperties&&e.threadProperties[o.iy.SpaceId];return(w(e)?e.id:(0,c.GW)(e)?nt(e):t)||e.teamId},rt=e=>{const t=e?e.trim().toLowerCase():void 0;return"true"!==t&&("false"===t||void 0)},at=e=>e.threadProperties&&((0,r.isBoolean)(e.threadProperties[o.iy.GapDetectionEnabled])?e.threadProperties[o.iy.GapDetectionEnabled]:"true"===(0,r.lowerCase)(e.threadProperties[o.iy.GapDetectionEnabled])),st=e=>!!Ae(e)&&ot(e),ot=e=>{const t=dt(e);return t&&!Ge(e)&&(0,r.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||lt(e.id)||lt(e.localClientId||"")},lt=e=>(0,r.startsWith)(e,o.hd),dt=e=>e.threadProperties&&e.threadProperties[o.iy.TenantId],ct=e=>{const t=e.threadProperties[o.iy.ArchivalLevel],n=w(e)&&!!t&&t.toLowerCase()===o.L6.Space.toLowerCase(),i=j(e)&&!!t&&(t.toLowerCase()===o.L6.Topic.toLowerCase()||t.toLowerCase()===o.L6.Space.toLowerCase());return n||i},pt=e=>{if(!e||!e.properties)return!1;const t=e.properties[o.H0.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},ut=e=>{const t=e.memberProperties?.[o.UO.RelationshipState],n=e.properties?.conversationstatus;return!!t?.inQuarantine||n===o.YH.AcceptPendingRecipient},mt=e=>{const t=e.memberProperties?.[o.UO.RelationshipState];return"number"==typeof t?.quarantineCounter?t?.quarantineCounter:0},ht=e=>!!e.memberProperties?.[o.UO.ExplicitlyAdded],gt=e=>e?.properties?.suppressLastMessageUpdate===o.XR.Sender,ft=e=>Ae(e)&&!e.usersProps?.hasFederatedUser&&(0,r.every)(e.members,(e=>e.id?.startsWith(o.kv)))||!1,Et=e=>!(!w(e)||parseInt(e.threadProperties?.[o.iy.SpaceTypes],10)!==d.QU.TenantWide),yt=(e,t)=>It(e.threadProperties&&e.threadProperties[o.iy.TenantId]||"",t),It=(e,t)=>!(!t||""===t||!e||e===t),At=(e,t)=>!(!w(e)||yt(e,t)||Et(e)||y(e)||!me(e)||te(e)),Ct=e=>{if(e?.meetingInfo)try{const t=["Accepted","Declined","Follow","Tentative","None"],n=JSON.parse(e.meetingInfo)?.rsvpStatus;return n&&t.includes(n)?n:"None"}catch(e){return"None"}return"None"},Tt=(e,t,n,i)=>{if(i&&n?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications&&i===e.threadProperties[o.iy.Creator])return!1;const{meetingChatNotification:r=p.AP.MeetingsUserParticipatesIn,meetingChatNotificationForAcceptedMeetings:s=p.AP.MeetingsUserIsInvitedTo,meetingChatNotificationForTentativeMeetings:l=p.AP.MeetingsUserParticipatesIn}={...t},d=p.AP.MeetingsUserIsInvitedTo,c=r!==d;if(!n?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications)return c||!1;const u=s!==d,m=l!==d;try{const t=e?.properties;switch(Ct(t)){case"Declined":case"Follow":return!0;case"Accepted":return u||!1;default:return m||!1}}catch(e){return m||!1}},St=(e,t,n,i)=>{const r=rt(e?.properties?.alerts);return void 0!==r?r:!!(0,s.Qi)(e.id)&&Tt(e,t,n,i)};function vt(e){if(!j(e)||U(e)||ee(e))return!1;const t=ue(e);return t!==o.uN&&(!t||t<Date.now())}const _t=e=>Dt(e)&&Y(e),Dt=e=>j(e)&&!y(e)&&!ct(e)&&B(e)&&me(e),bt=(e,t)=>{const n=e.threadProperties[o.iy.CreatedAt]||"0";return Mt(n)<t},Pt=(e,t)=>e.threadProperties[o.iy.Creator]===t,Nt=e=>w(e)&&"General"!==e.threadProperties[o.iy.TopicThreadTopic],Mt=e=>(0,u.Ql)(parseInt(e,10),Date.now(),"seconds"),Rt=(e,t,n)=>!!n.get(a.w.Messaging).enableMessagingGoldenGateCSV1&&(0,m.x_)(e.id)&&!me(e,t),Ft=(e,t)=>!!t.get(a.w.Messaging).enableMessagingGoldenGateCSV1&&(0,m.tK)(e.id)&&C(e),wt=(e,t)=>{const n=!!t.get(a.w.ChatList)?.disableDeletedOrQuarantinedChats,i=C(e),r=ut(e);return n&&(i||r)}},596497:(e,t,n)=>{n.d(t,{Ak:()=>s,tK:()=>p,x_:()=>u,W:()=>m,EQ:()=>h,io:()=>g,B5:()=>f,uu:()=>E,FH:()=>I,Bh:()=>A,Ik:()=>C});var i=n(332752),r=n(46377),a=n(821296);const s="@thread.v2",o="@oneToOne.skype",l=/^8:(.+?):8:(.+)$/,d=1738368e6,c=1751328e6,p=e=>e?.startsWith(r.gN.SkypeSpacesThread)&&e?.endsWith(o),u=e=>e?.startsWith(r.gN.SkypeSpacesThread)&&(e?.includes(o)||e?.includes("@thread.skype")||e?.includes("@p2p.thread.skype")),m=e=>!!e&&l.test(e),h=e=>!(!e||!p(e.id)||!e.threadProperties?.onetoonev2threadid?.includes(s)&&!e.properties?.onetoonev2threadid?.includes(s));function g(e,t,n,r,s,o){const l=r?.get(i.w.Messaging)?.enableSkypeMessagesInTFL;if(!l)return!1;const p=new Date(r?.get(i.w.Messaging).goldenGateCutOffDate||d),m=new Date(r?.get(i.w.Messaging)?.csv2MigrationCutOffDate||c),h=t?new Date(t):null;return e?.formatVariant?e?.formatVariant===a.kI.Sfl:!!(y(o)||h&&h<p&&s===a.z_.SFL||h&&u(n)&&h<m)}function f(e){return!!e?.endsWith(r.Ih)}function E(e){return e.members?.some((e=>e.id?.startsWith(r.gN.Lync)))||!1}const y=e=>{const t=new Set([r.Go.URIAudioObject,r.Go.MediaGenericFile,r.Go.UriVideoObject]);return!!e&&t.has(e)},I=(e,t)=>{const{enableSkypeMessagesInTFL:n,skypeBotIds:a}=t?.get(i.w.Messaging)??{};if(!n)return!1;return new Set([r.Go.SkypeTranslation,r.Go.SkypeCopilotToggle,r.Go.SkypeTranslationSettings]).has(e.type)||a?.some((t=>e.from?.includes(t)))||e.type===r.Go.AddMember&&a?.some((t=>e.content?.includes(t)))},A=(e,t)=>!!u(e?.id)&&!e.members?.some((({id:e})=>e===t));const C=(e,t,n,i)=>{let r="";return e&&(r=function(e,t,n,i){try{if(e)return JSON.parse(e).CounterpartyMri}catch(e){n.warn(`conversationstatusproperties parsing failed for ${t}`,i)}return""}(e?.properties?.conversationstatusproperties,e?.id,n,i),r||2!==e?.members?.length||(r=e?.members.find((({id:e})=>e!==t))?.id||"")),r||""}},676915:(e,t,n)=>{n.d(t,{h:()=>r});var i=n(46377);const r=(e,t,n)=>{if(t===i.Go.HTML){if(a(e,n))return i.Go.Collaborate;if(s(e,n))return i.Go.Embed}return t},a=(e,t)=>{const n=o(e,t);if(!n)return!1;const i=n.find((e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!i&&!!i.content.componentUrl},s=(e,t)=>{const n=o(e,t);if(!n)return!1;const i=n.find((e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!i&&!!i.content.componentUrl},o=(e,t)=>{if(t?.cards)try{return JSON.parse(t.cards)}catch(t){e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards.")}return null}},875880:(e,t,n)=>{n.d(t,{AP:()=>i,nM:()=>r,$Q:()=>a,KO:()=>s,I_:()=>o,vn:()=>l});const i={MeetingsUserIsInvitedTo:"MeetingsUserIsInvitedTo",MeetingsUserParticipatesIn:"MeetingsUserParticipatesIn",MeetingsManuallyUnmuted:"MeetingsManuallyUnmuted"},r={VOICE_CALL:"VOICE_CALL",VIDEO_CALL:"VIDEO_CALL"},a={aggregatedLikeInChatAndChannel:"AggregatedLikeInChatAndChannel",aggregatedMentionsInTeamAndChannel:"AggregatedMentionsInTeamAndChannel",aggregatedPersonalMention:"AggregatedPersonalMention",aggregatedReplyAndReplyToReply:"AggregatedReplyAndReplyToReply",aggregatedRepliesToPostsAndThreads:"AggregatedRepliesToPostsAndThreads",alertSound:"alertSound",alertSoundType:"alertSoundType",alertUrgentSoundType:"alertUrgentSoundType",allowUrgentNotifications:"allowUrgentNotifications",appNotificationEnabled:"appNotificationEnabled",callTransferFailed:"CallTransferFailed",chat:"Chat",dLPNotifySender:"DLP_NotifySender",dLPWarning:"DLP_Warning",downloaded:"Download_Downloaded",downloadFailed:"Download_DownloadFailed",downloadStarted:"Download_DownloadStarted",emailDigestDelay:"EmailDigestDelay",emailNotificationDelay:"EmailNotificationDelay",error:"Error",followChannelNewMessage:"Follow_ChannelNewMessage",followChannelReplyMessage:" Follow_ChannelReplyMessage",globalMention:"Global_Mention",globalSoundAndPreview:"GlobalSoundAndPreview",hideNotificationDuringCallsAndMeetings:"HideNotificationDuringCallsAndMeetings",huddleStartedNotification:"HuddleStartedNotification",liveMeetingStatusBanner:"liveMeetingStatusBanner",incomingCallsAndMeetingStartSound:"IncomingCallsAndMeetingStartSound",inferred:"Inferred",like:"Like",likeInChat:"LikeInChat_v2",newContactOnTeamsNotification:"newContactOnTeamsNotification",meetingChatNotification:"MeetingChatNotification",meetingChatNotificationForAcceptedMeetings:"MeetingChatNotification_AcceptedMeeting",meetingChatNotificationForTentativeMeetings:"MeetingChatNotification_TentativeMeeting",meetingWentLiveNotification:"MeetingWentLiveNotification",mentionChannel:"Mention_Channel",mentionInChat_Everyone:"MentionInChat_Everyone",mentionInChat_Nearby:"MentionInChat_Nearby",mentionInChat_Person:"MentionInChat_Person_v2",mentionPerson:"Mention_Person",mentionTag:"Mention_Tag",mentionTeam:"Mention_Team",messageSendFailed:"MessageSendFailed",msGraphChannelMeetingCanceled:"channelMeetingCanceled",msGraphChannelMeetingCreated:"channelMeetingCreated",msGraphChannelMeetingForwarded:"channelMeetingForwarded",msGraphChannelMeetingForwardedWithoutOrganizer:"channelMeetingForwardedWithoutOrganizer",msGraphChannelMeetingUpdated:"channelMeetingUpdated",msGraphDelegateMeetingCanceled:"delegateMeetingCanceled",msGraphDelegateMeetingCreated:"delegateMeetingCreated",msGraphDelegateMeetingUpdated:"delegateMeetingUpdated",msGraphMeetingOrganisedByMe:"privateMeetingForwardedNotification",msGraphMeetingSentToMe:"privateMeetingCreated",msGraphPrivateMeetingCanceled:"privateMeetingCanceled",msGraphPrivateMeetingForwarded:"privateMeetingForwarded",msGraphPrivateMeetingForwardedNotificationWithAttendee:"privateMeetingForwardedNotificationWithAttendee",msGraphPrivateMeetingForwardedNotificationWithAttendeeAndTotal:"privateMeetingForwardedNotificationWithAttendeeAndTotal",msGraphPrivateMeetingForwardedNotificationWithTwoAttendee:"privateMeetingForwardedNotificationWithTwoAttendee",msGraphPrivateMeetingUpdated:"privateMeetingUpdated",muteGenericNotifications:"muteGenericNotifications",notificationStyleList:"NotificationStyleList",playNotificationSoundsForUrgentAndPriority:"PlayNotificationSoundsForUrgentAndPriority",playNotificationSoundsWhenBusyOrInMeetings:"PlayNotificationSoundsWhenBusyOrInMeetings",presenceStatus:"PresenceStatus",priority:"Priority",projectBoardAssignments:"ProjectBoardAssignments",repliesInFollowedThreads:"RepliesInFollowedThreads",reply:"Reply",replyToPolls:"ReplyToPolls",replyToReply:"ReplyToReply",resetTeamsAndChannelsSettings:"Reset_Teams_And_Channels_Settings",respectOsDnDForCustomToasts:"RespectOsDnDForCustomToasts",selectedPreset:"selectedPreset",showNotificationDuringCallsAndMeetings:"ShowNotificationDuringCallsAndMeetings",showPreviewInToasts:"ShowPreviewInToasts",showUnreadChatsRemindersInToasts:"showUnreadChatsRemindersInToasts",staffHub:"StaffHub",teamMembershipChangeAddedToSharedChannel:"TeamMembershipChange_AddedToSharedChannel",teamMembershipChangeAddedToTeam:"TeamMembershipChange_AddedToTeam",teamMembershipChangePendingOnBehalfOfJoinRequest:"TeamMembershipChange_PendingOnBehalfOfJoinRequest",teamMembershipChangePendingOnBehalfOfJoinRequestMultiple:"TeamMembershipChange_PendingOnBehalfOfJoinRequestMultiple",teamMembershipChangePendingSelfJoinRequest:"TeamMembershipChange_PendingSelfJoinRequest",teamMembershipChangePromotedToSharedChannelOwner:"TeamMembershipChange_PromotedToSharedChannelOwner",teamMembershipChangePromotedToTeamAdmin:"TeamMembershipChange_PromotedToTeamAdmin",teamMembershipChannelOwnerUnshareTeamOwnerNotify:"TeamMembershipChange_ChannelOwnerUnshareTeamOwnerNotify",teamMembershipTeamOwnerUnshareChannelOwnerNotify:"TeamMembershipChange_TeamOwnerUnshareChannelOwnerNotify",teamMembershipTeamShareTeamOwnerNotify:"TeamMembershipChange_TeamShareTeamOwnerNotify",teamsTasks:"TeamsTasks",thirdParty_Bot:"ThirdParty_Bot",trending:"Trending",useTeamsChimeForToasts:"useTeamsChimeForToasts",visibleChannelMention_v2:"Visible_ChannelMention_v2",visibleChannelNewMessage_v2:"Visible_ChannelNewMessage_v2",visibleChannelReplyMessage_v2:"Visible_ChannelReplyMessage_v2"};var s,o;!function(e){e[e.AllActivity=1]="AllActivity",e[e.MyAtMentions=2]="MyAtMentions",e[e.Custom=3]="Custom"}(s||(s={})),function(e){e.MainPage="notification_settings_text",e.GraphPage="notification_settings_graph_apps_subheader_text",e.ChatPage="notification_settings_details_chat_subheader_text",e.MeetingsPage="notification_settings_details_only_meetings_subheader_text",e.TeamsChannelCustomisedPage="notification_settings_details_teams_channel_button_custom_label",e.CallGroupPage="group_call_forwarding_notification_setting"}(o||(o={}));const l="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"},514188:(e,t,n)=>{function i(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const n={};return e.split("&").forEach((e=>{const[t,i]=e.split("=");n[t]=decodeURIComponent((i||"").replace(/^.+?(=)/,""))})),n}n.d(t,{J:()=>i})},998606:(e,t,n)=>{var i,r,a,s,o;n.d(t,{A2:()=>i,UI:()=>r,LF:()=>a,Fo:()=>s,D1:()=>o}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(i||(i={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(r||(r={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(a||(a={})),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(s||(s={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(o||(o={}))},988536:(e,t,n)=>{n.d(t,{a:()=>r});var i=n(364819);class r{constructor(){this._card={type:"AdaptiveCard",version:"1.5",body:[{type:"Container",items:[]}],actions:[]}}addLabel(e){return this.addElement({type:"TextBlock",text:e,weight:"bolder"}),this}addTextBlock(e,t,n,i,r){return this.addElement({type:"TextBlock",text:e,wrap:t,spacing:n,maxLines:i,size:r}),this}addTextInput(e,t,n,i,r,a){return this.addElement({type:"Input.Text",id:e,placeholder:t,value:n,maxLength:i,isMultiline:r,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addNumberInput(e,t,n,i){return this.addElement({type:"Input.Number",id:e,placeholder:t,value:n,label:i?.label,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addDateInput(e,t,n,i){return this.addElement({type:"Input.Date",id:e,placeholder:t,value:n,label:i?.label,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addTimeInput(e,t,n,i){return this.addElement({type:"Input.Time",id:e,placeholder:t,value:n,label:i?.label,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addToggle(e,t,n,i){return this.addElement({type:"Input.Toggle",id:e,title:t,value:n,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addChoiceSet(e,t,n,i,r,a,s){return this.addElement({type:"Input.ChoiceSet",id:e,title:t,isMultiSelect:n,style:i?"compact":"expanded",choices:r,value:a,label:s?.label,isRequired:s?.isRequired,errorMessage:s?.errorMessage}),this}addImageSet(e,t){return this.addElement({type:"ImageSet",id:e,images:t}),this}addSubmitAction(e,t,n,i){return this._card.actions&&this._card.actions.push({id:e,type:"Action.Submit",title:t,data:n,style:i?.style}),this}addSpeak(e){return this._card.speak=e,this}getCard(){return{content:JSON.stringify(this._card),contentType:"application/vnd.microsoft.card.adaptive"}}getRawJson(){return(0,i.cloneDeep)(this._card)}addColumnSet(e,t){return this.addElement({type:"ColumnSet",columns:e,spacing:t}),this}addSelectAction(e,t){return this._card.selectAction={type:"Action.OpenUrl",url:t,id:e},this}addElement(e){this._card.body&&this._card.body[0].items.push(e)}}},74798:(e,t,n)=>{function i(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}n.d(t,{v:()=>i})},900301:(e,t,n)=>{n.d(t,{JT:()=>a,oJ:()=>s,M5:()=>o,Gu:()=>d,hR:()=>c});var i=n(364819),r=n(355515);function a(e,t,n){return e=l(e,t,n=n||s),1===t.length&&"object"==typeof t[0]&&(e=l(e,t[0],n)),e}function s(e){if(null===e)return"null";if(void 0===e)return"undefined";const t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if((0,i.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return c(e)}}function o(e,t){let n=`[errorType=${typeof e}]`;return n+=e?"object"==typeof e?`[errorName=${e.name}][errorMessage=${e.message}][errorStack=${e.stack}]`:`[error=${e.toString()}]`:`[error=Undefined ${t} Error]`,(0,r.Mr)(n)}function l(e,t,n){for(const i in t)t.hasOwnProperty(i)&&(e=e.replace(`{${i}}`,n(t[i])));return d(e)}function d(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function c(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}},804510:(e,t,n)=>{n.d(t,{j:()=>i});const i=(e,t={},n)=>{let i;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');i=JSON.parse(e)}catch(e){i=t,n?.(e)}return i}},348103:(e,t,n)=>{function i(){return(...e)=>e}n.d(t,{K:()=>i})},997853:(e,t,n)=>{n.d(t,{OV:()=>o,$G:()=>d});var i=n(46377),r=n(260465),a=n(364819),s=n(933370);function o(e){const[t,n,r]=function(e){const t=3,n=e.split(";");return n&&n.length===t&&n[0]&&!isNaN(Number(n[0]))&&n[1]&&!isNaN(Number(n[1]))&&n[2]&&!(0,a.isNil)(Number(n[2]))?n:i.S0.split(";")}(e),s=Number(n)||0;return{originalArrivalTime:Number(t)||0,timeStamp:s,clientMessageId:r}}const l=(e,t)=>(0,r.r0)(t.type,t.id)?e.chat:(0,r.Mn)(t.type)?e.channel:void 0;function d(e,t){const n=o(e.properties&&e.properties[i.H0.ConsumptionHorizon]||i.S0);if(t){const i=l(t,e)||-1;if(p(e,n.originalArrivalTime,i)||u(e,n.originalArrivalTime,i))return n;n.originalArrivalTime=Math.max(n.originalArrivalTime,i)}return n}const c=e=>{e=e?.toString();return 0!==new Date(e&&"0"!==e?e:s.EJ).valueOf()},p=(e,t,n)=>(0,r.r0)(e.type,e.id)&&e.threadProperties?.lastjoinat>n&&!c(t),u=(e,t,n)=>{const a=parseInt(e.threadProperties?.[i.iy.CreatedAt]||"0",10);return(0,r.Mn)(e.type)&&a>n&&!c(t)}},648816:(e,t,n)=>{n.d(t,{zJ:()=>i,Iq:()=>r,io:()=>a});const i=(e,t,n)=>`${e}:${t}:${n}`,r=(e,t)=>`${e}:${t}`,a=(e,t)=>`${e}:${t}`},508411:(e,t,n)=>{n.d(t,{F6:()=>s,Q2:()=>l,a9:()=>d,Uf:()=>c,l7:()=>p,dG:()=>u,sZ:()=>m,XU:()=>h,qh:()=>g});var i=n(364819),r=n(942016),a=n(46377);function s(e,t){try{const n=o(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,i.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const i=e.split(".");for(let e=0;e<i.length;e++)t+=(e>0?"[.]":"")+i[e].replace(/\*/g,"[^/^.]+");const r=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(n.match(r))return!0}}catch{return!1}return!1}const o=e=>new URL(e).href,l=e=>e?.replace(/;messageid=.*/,""),d=(e,t,n,i)=>{let a="";if(!e.id||p(e.id))return a;switch(e.type){case r.ck.extensions:try{a=JSON.parse(e.id).threadId||n}catch(t){a=e.id||n||""}break;case r.ck.chats:case r.ck.chatthread:case r.ck.callingchats:a=e.id.replace("replyChainId","messageid");break;case r.ck.communities:case r.ck.channels:t=t??i;case r.ck.channelthread:let s;try{s=JSON.parse(e.id).channelId}catch{s=e.id}a=t?`${s};messageid=${t}`:s;break;case r.ck.shareformdialog:break;case r.ck.meetingcollaboration:default:a=e.id}return a},c=e=>e&&e.replace(new RegExp(`^${a.gN.BotPrefix}`),""),p=e=>"newchat"===e||e?.includes("preview"),u=(e,t=a.Go.Call)=>t===a.Go.Call&&/<partlist/.test(e)&&!g(e,t),m=(e,t)=>!!h(e,t)&&g(e),h=(e,t)=>t===a.Go.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>'),g=(e,t=a.Go.Call)=>t===a.Go.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},262775:(e,t,n)=>{n.d(t,{R1:()=>i,CK:()=>r,fe:()=>a,ff:()=>s,z4:()=>o,xp:()=>l,pN:()=>d,vg:()=>c,IO:()=>p,$3:()=>u,tV:()=>m,BK:()=>h,jL:()=>g,ae:()=>f,zu:()=>E,nW:()=>y,rA:()=>I,lk:()=>A,cP:()=>C,lP:()=>T,PX:()=>S,kG:()=>v,Y2:()=>_,ro:()=>D,LA:()=>b,R6:()=>P,jH:()=>N,GU:()=>M,AY:()=>R,FV:()=>F});const i={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",fetchPreviewInfo:"/_api/v2.0/shares/{shareID}/driveItem/preview",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1=",getFileWebDavUrl:"/_api/v2.1/drives/{driveId}/items/{itemId}?$select=webDavUrl",getFileDetails:"/_api/v2.1/drives/{driveId}/items/{itemId}?$select=id,name,webDavUrl"}},r={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},a={personal:"personal",teams:"teams"},s={bim:"bim",mw:"mw",ns:"ns",rwc:"rwc"},o="3a867b4a-7429-0e1a-b02e-bf4b240ff1ce",l=["splistform"],d=["splistform"],c={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${a.personal}/[^/]*/`,sharePointFile:`.*/(${a.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/,spPageRegex:/(?:.*\/SitePages\/|.*\/:u:\/t.*)/,spFormsUrlRegex:/(.*\/:l:\/.*?nav=.*|.*\/listforms.aspx.*)/,spListUrlRegex:/(?:.*\/:l:\/|.*\/Lists\/.*)/,spListItemUrlRegex:/(?:.*\/Lists\/.*?ID=.*|.*\/:li:\/.*)/,spListItemPersonalUrlRegex:`/.*/${a.personal}/.*/Lists/.*/`},p={personal:"personal",sharePoint:"share-point"},u={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},m={type:"oneNote",extension:"one",extensionWithDot:".one"},h={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},g={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},f={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",invalidRequest:"invalidRequest",fileAccessDenied:"FileAccessDenied",accessDenied:"accessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked",authChallengeRequired:"authChallengeRequired",InteractionRequired:"InteractionRequired"};var E,y,I,A,C;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI",e.videUploadAsAttachment="VIDEO_UPLOAD_AS_ATTACHMENT",e.imageFileSizeExceeds="IMAGE_FILE_SIZE_EXCEEDS",e.imageDimensionExceeds="IMAGE_DIMENSION_EXCEEDS"}(E||(E={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(y||(y={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(I||(I={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedGuestAndAnonymousCSL="files_messages_sharelink_federated_guest_anonymous_csl",e.ShareLinkFederatedAndAnonymousCSL="files_messages_sharelink_federated_anonymous_csl",e.ShareLinkGuestAndAnonymousCSL="files_messages_sharelink_guest_anonymous_csl",e.ShareLinkAnonymousCSL="files_messages_sharelink_anonymous_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel",e.ShareLinkCSLGeneric="files_messages_sharelink_csl_generic",e.ShareLinkCSLXTenantSharedChannelGeneric="files_messages_sharelink_csl_xtenant_sharedchannel_generic",e.ShareLinkFederatedAndGuestCSLGeneric="files_messages_sharelink_federated_and_guest_csl_generic",e.ShareLinkFederatedCSLGeneric="files_messages_sharelink_federated_csl_generic",e.ShareLinkPSLWithoutFullAccessGeneric="files_messages_sharelink_psl_without_full_access_generic",e.ShareLinkPSLWithoutFullAndFutureAccessGeneric="files_messages_sharelink_psl_without_full_and_future_access_generic",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannelGeneric="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel_generic",e.ShareLinkPSLWithoutFutureAccessGeneric="files_messages_sharelink_psl_without_future_access_generic",e.ShareLinkPSLWithoutIndividualAccessGeneric="files_messages_sharelink_psl_without_individual_access_generic",e.ShareLinkAutoPSL="files_messages_sharelink_auto_psl"}(A||(A={})),function(e){e.StringFile="string_file",e.StringList="string_list",e.StringItem="string_item",e.StringForm="string_form",e.StringPlaylist="string_playlist"}(C||(C={}));const T=100,S=10485760,v=12e4,_=3e5,D=600;var b;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(b||(b={}));const P="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var N;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains",e.ObjectUrlMissing="ObjectUrlMissing"}(N||(N={}));const M="https://my.microsoftpersonalcontent.com",R="/v2/.default",F={file:C.StringFile,splist:C.StringList,splistitem:C.StringItem,splistplaylist:C.StringPlaylist,splistform:C.StringForm}},244698:(e,t,n)=>{function i(e=1){const t=new Uint32Array(e),i=n.g;if(i.msCrypto)i.msCrypto.getRandomValues(t);else if(i.crypto)i.crypto.getRandomValues(t);else{let n=e;for(;n--;){const e=4294967296;t[n]=Math.floor(Math.random()*e)}}return Array.from(t)}function r(e){return 0===(t=1/e,Math.floor(Math.random()*t));var t}n.d(t,{yT:()=>i,Dz:()=>r})},16039:(e,t,n)=>{n.d(t,{Gn:()=>a,Vs:()=>s,wK:()=>o,LS:()=>l,Dt:()=>u,aI:()=>m,Bs:()=>h,M1:()=>f,Cd:()=>E,c3:()=>I,Aw:()=>A,RG:()=>C,HD:()=>T,Kw:()=>D,K5:()=>M,k5:()=>R,yY:()=>F,zl:()=>w,Gd:()=>O,$Q:()=>U,if:()=>L,qF:()=>k,mz:()=>G,EK:()=>x,U$:()=>B});var i=n(942016),r=n(277362);const a="m365DefaultApp",s="tmp.m365DefaultApp",o=globalThis.localStorage;var l,d,c,p;!function(e){e.unified="unified",e.split="split",e.none="none"}(l||(l={})),function(e){e.teamsAndChannels="teamsAndChannels",e.apps="apps",e.customSection="customSection",e.favorites="favorites",e.hiddenChannels="hiddenChannels",e.recentChats="recentChats",e.recentChannels="recentChannels",e.engageCommunities="engageCommunities",e.meetingChats="meetingChats"}(d||(d={})),function(e){e.user="user",e.admin="admin",e.guest="guest",e.shadow="shadow"}(c||(c={})),function(e){e.regular="Regular",e.private="Private",e.shared="Shared",e.standalone="Standalone"}(p||(p={}));const u=(e,t,n)=>e&&n?.hasUserEnabledAdaptiveRailForDesktop?t&&!1===n?.hasUserEnabledUnifiedAppForDesktop?l.split:l.unified:l.none,m=e=>{const{hasUserEnabledAdaptiveRailForDesktop:t}=e;return!!t},h=(e,t,n)=>{const{hasUserEnabledMessagePreviews:i,hasUserEnabledMessagePreviewsForSplitApp:r}=e,a=E(e);return l.split===a?r??i??g(!!n?.splitMessagePreview,t):i??(n?.fallbackMessagePreviewForUnified?g(!!n?.unifiedMessagePreview,t):!!n?.unifiedMessagePreview)},g=(e,t)=>{const{messagePreviewsSetting:n,isComfyChatDensity:i}=t??{};return O(n)?e:M(n,i)},f=(e,t)=>{const{hasUserEnabledShowTimeStamps:n,hasUserEnabledShowTimeStampsForSplitApp:i}=e,r=E(e);return l.split===r?i??n??!!t?.splitTimestampPreview:n??!!t?.unifiedTimestampPreview},E=e=>{const{hasUserEnabledUnifiedAppForDesktop:t}=e;return!1===t?l.split:l.unified},y=e=>"linkedEntity"in e,I=e=>!!e.mainEntity&&(e.mainEntity.type===i.ck.chats||y(e.mainEntity)&&(e.mainEntity.linkedEntity?.type===i.ck.chats||e.mainEntity.linkedEntity?.type===i.ck.simplecollabchats)),A=e=>!!e.mainEntity&&(e.mainEntity.type===i.ck.channels||y(e.mainEntity)&&(e.mainEntity.linkedEntity?.type===i.ck.channels||e.mainEntity.linkedEntity?.type===i.ck.simplecollabchannels)),C=e=>!!e?.mainEntity&&e?.mainEntity?.type===i.ck.extensions,T=e=>e?.mainEntity?.type===i.ck.headlineslice||v(e?.mainEntity?.type),S=e=>v(e?.subNavEntity?.type),v=e=>e===i.ck.headlinesliceolk||_(e),_=e=>e===i.ck.simplecollabslices,D=(e,t,n)=>{if(!e)return null;if(b(n)&&e.mainEntity){const a=I(e),s=A(e),o=S(r=e)||T(r);if(!a&&!s&&!o)return null;if(a&&t.type!==i.ck.chats&&t.type!==i.ck.simplecollabchats&&t.type!==i.ck.simplecollab)return null;if(s&&t.type!==i.ck.channels&&t.type!==i.ck.simplecollabchannels&&t.type!==i.ck.simplecollab)return null;const l=P(e,n);let d=N(n);return o&&("midNavEntity"===n?((e=>_(e?.mainEntity?.type)||_(e?.subNavEntity?.type))(e)?e.mainEntity.type=i.ck.simplecollabslices:e.mainEntity.type=i.ck.headlinesliceolk,e.subNavEntity=e.mainEntity,e.endEntity=null,d=""):e.mainEntity.type=i.ck.headlineslice),{...e,[n]:{...l,type:t.type,action:t.action,id:t.id??l?.id,linkedEntity:(t.linkedEntity??l?.linkedEntity)||null,entityState:l?.entityState??{flushableByLinkedEntity:!0,__typename:"EntityState"},windowOptions:l?.windowOptions||null,options:l?.options||null},[d]:null}}var r;return null},b=e=>"subNavEntity"===e||"midNavEntity"===e||"mainEntity"===e,P=(e,t)=>{let n;return n="midNavEntity"===t?e.subNavEntity?e.subNavEntity:e.midNavEntity:e.midNavEntity?e.midNavEntity:e.subNavEntity,n},N=e=>"midNavEntity"===e?"subNavEntity":"midNavEntity",M=(e,t)=>"default"===e?t:"showPreviews"===e,R=e=>{const{hasUserEnabledUnifiedAppForDesktop:t}=e;return!1===t},F=e=>{const{hasUserEnabledMessagePreviews:t,hasUserEnabledMessagePreviewsForSplitApp:n}=e;return{hasUserEnabledMessagePreviews:t??null,hasUserEnabledMessagePreviewsForSplitApp:n??null}},w=e=>{const{hasUserEnabledShowTimeStamps:t,hasUserEnabledShowTimeStampsForSplitApp:n}=e;return{hasUserEnabledShowTimeStamps:t??null,hasUserEnabledShowTimeStampsForSplitApp:n??null}},O=e=>!e||"default"===e,U=(e,t,n)=>{if(!e||t!==r.p.ChatDeeplinkMessage||!n)return!1;const i=e.split(";replyChainId=");return i.length<=1||i[1].trim().length<=0},L=(e,t)=>{switch(e){case"RECENT_CHATS":return d.recentChats;case"TEAMS_AND_CHANNELS":return d.teamsAndChannels;case"HIDDEN_CHANNELS":return d.hiddenChannels;case"APPS":return d.apps;case"RECENT_CHANNELS":return d.recentChannels;case"ENGAGE_COMMUNITIES":return d.engageCommunities;case"MEETING_CHATS":return d.meetingChats;default:return t?d.favorites:d.customSection}},k=e=>{switch(e){case"USER":return c.user;case"ADMIN":return c.admin;case"GUEST":return c.guest;case"SHADOW":return c.shadow;default:return}},G=e=>{switch(e){case"STANDARD":return p.regular;case"PRIVATE":return p.private;case"SHARED":return p.shared;case"STANDALONE":return p.standalone;default:return}},x=e=>{switch(e){case"CHANNELS_ONLY":return"recentChannels";case"TEAMS_AND_CHANNELS":return"teamsAndChannels";default:throw new Error(`Unsupported viewType: ${e}`)}},B=e=>{switch(e){case"OneGQL_ChannelConversation":return"channel";case"OneGQL_EngageCommunityConversation":return"engage-community";default:return"chat"}}},878344:(e,t,n)=>{n.d(t,{y:()=>a});var i=n(362328),r=n(292992);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appDefinition($appId:ID!,$scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinition(appId:$appId,scope:$scope,conversationId:$conversationId,options:$options) {...appDefinition}}");return delete this.definitions,this.definitions=[...e.definitions,...r.h.definitions]}}},66155:(e,t,n)=>{n.d(t,{T:()=>a});var i=n(362328),r=n(292992);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appDefinitions($scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinitions(scope:$scope,conversationId:$conversationId,options:$options) {...appDefinition}}");return delete this.definitions,this.definitions=[...e.definitions,...r.h.definitions]}}},232122:(e,t,n)=>{n.d(t,{qn:()=>i,e6:()=>s,bf:()=>o,xK:()=>l,ag:()=>d,Q4:()=>c,c5:()=>p,$R:()=>u,yq:()=>m,dU:()=>h,pJ:()=>g,oD:()=>f,Wl:()=>E,GD:()=>I,v8:()=>A,ZQ:()=>C,kp:()=>T,Cn:()=>S,WX:()=>v,td:()=>_,LY:()=>D,zh:()=>N,TW:()=>R});var i,r=n(792055),a=n(364819);!function(e){e.Bot="Bot",e.Connector="Connector",e.Messaging="Messaging",e.StaticTabs="StaticTabs",e.GalleryTab="GalleryTab"}(i||(i={}));const s=e=>!!e&&b(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),o=e=>P(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),l=e=>"InstalledApp"===e?.__typename&&!(0,a.isUndefined)(e?.definition),d=e=>!!e&&b(e,["InstalledAndPermanent"]),c=e=>!!e&&b(e,["Featured"]),p=e=>!!e&&b(e,["PreConsented"]),u=e=>P(e,["PreConsented"]),m=e=>b(e,["RequireConsent"]),h=e=>P(e,["RequireConsent"]),g=e=>b(e,["NotInstalled"]),f=e=>e&&(E(e.definition,i.Bot,"Personal")||E(e.definition,i.StaticTabs,"Personal"))||!1,E=(e,t,n)=>{if(!e)return!1;switch(t){case i.Bot:return e.bots&&(0,a.first)(e.bots)&&(0,a.includes)(e.bots[0].scopes,n)||!1;case i.StaticTabs:return e.staticTabs&&(0,a.first)(e.staticTabs)&&(0,a.includes)(e.staticTabs[0].scopes,n)||!1;default:return!1}},y=(e,t)=>e.installedScope&&e.installedScope.includes(t),I=e=>s(e)&&y(e,"Personal"),A=(e,t=!1)=>{const n=c(e)||s(e)&&(y(e,"GroupChat")||y(e,"Team"));return t?n||p(e):n},C=e=>!g(e)&&"Team"===e.installedScope&&"Enabled"===e.statusInfo?.status,T=e=>!g(e)&&"Team"===e.installedScope&&"Disabled"===e.statusInfo?.status,S=e=>s(e)&&(y(e,"GroupChat")||y(e,"Team")),v=e=>{const t=e.data&&e.data.installApp;return!!t&&"InstalledApp"===t.__typename},_=e=>{const t=e.data&&e.data.installCustomApp;return!!t&&"InstalledApp"===t.__typename},D=e=>{const t=e.data&&e.data.upgradeApp;return!!t&&"InstalledApp"===t.__typename},b=(e,t)=>(0,a.includes)(t,e.installationState),P=(e,t)=>(0,a.includes)(t,e),N=e=>{let t="",n="";if(e&&e.length>0){const i=e.indexOf(r.fc.statusKey),a=e.indexOf(r.fc.errorCodeKey);t=i>-1?`Http status code: ${M(e.substr(i),r.fc.statusKey)}`:`Http status code: ${r.bF}`,n=a>-1?`Error code: ${M(e.substr(a),r.fc.errorCodeKey)}`:`Error code: ${r.kb.NoSpecificErrorMessageFound}`}return`${t}. ${n}`},M=(e,t)=>{const n=e.length>0?e.split(","):[];if(n.length>0){const e=n[0].replace(/[\\"'{}\s]/g,"").split(":");if(e.length>1&&(t===r.fc.statusKey&&e[1]in r.kG||t===r.fc.errorCodeKey&&e[1]in r.kb))return e[1]}return t===r.fc.statusKey?r.bF:r.kb.NoSpecificErrorMessageFound},R=()=>`${`Http status code: ${r.bF}`}. ${`Error code: ${r.kb.NoSpecificErrorMessageFound}`}`},792055:(e,t,n)=>{var i,r;n.d(t,{kb:()=>i,kG:()=>r,bF:()=>a,fc:()=>s,gY:()=>o}),function(e){e.NoSpecificErrorMessageFound="NoSpecificErrorMessageFound",e.Unknown="Unknown",e.Unauthorized="Unauthorized",e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.NotFound="NotFound",e.AppScopeIsNotAllowed="AppScopeIsNotAllowed",e.AppIsNotInstalledInTheChat="AppIsNotInstalledInTheChat",e.AppIsNotInstalledInTheTeam="AppIsNotInstalledInTheTeam",e.AppIsNotActivelyInstalled="AppIsNotActivelyInstalled",e.AppIsBlockedByAppPermissionPolicy="AppIsBlockedByAppPermissionPolicy",e.UnknownFailureToParseTeamsAppManifest="UnknownFailureToParseTeamsAppManifest",e.UnableToParseTeamsAppManifest="UnableToParseTeamsAppManifest",e.AppSideloadingForbidden="AppSideloadingForbidden",e.CreateGroupChatAppDefinitionFailed="CreateGroupChatAppDefinitionFailed",e.AppDefinitionAlreadyExists="AppDefinitionAlreadyExists",e.AppDefinitionDoesntExist="AppDefinitionDoesntExist",e.UpdateGroupChatAppDefinitionFailed="UpdateGroupChatAppDefinitionFailed",e.GetAppDefinitionFailed="GetAppDefinitionFailed",e.GetGlobalAppDefinitionsFailed="GetGlobalAppDefinitionsFailed",e.AppDefinitionUpdateNotPermitted="AppDefinitionUpdateNotPermitted",e.AppEntitlementAlreadyExists="AppEntitlementAlreadyExists",e.CreateGroupChatAppEntitlementFailed="CreateGroupChatAppEntitlementFailed",e.CreateTeamAppEntitlementFailed="CreateTeamAppEntitlementFailed",e.GroupChatEntitlementDoesntExist="GroupChatEntitlementDoesntExist",e.TeamAppEntitlementsDontExist="TeamAppEntitlementsDontExist",e.UserAppEntitlementsDontExist="UserAppEntitlementsDontExist",e.TenantAppEntitlementsDontExist="TenantAppEntitlementsDontExist",e.UpgradeTeamAppEntitlementFailed="UpgradeTeamAppEntitlementFailed",e.UpgradeUserAppEntitlementFailed="UpgradeUserAppEntitlementFailed",e.UpgradeGroupChatAppEntitlementFailed="UpgradeGroupChatAppEntitlementFailed",e.GetUserEntitlementsFailed="GetUserEntitlementsFailed",e.GetDefaultUserAppEntitlementsFailed="GetDefaultUserAppEntitlementsFailed",e.SetUserAppEntitlementFailed="SetUserAppEntitlementFailed",e.PermanentAppEntitlementUpdateNotAllowed="PermanentAppEntitlementUpdateNotAllowed",e.GetUserAggregatedAppsFailed="GetUserAggregatedAppsFailed",e.TemplatedAppNotAllowedByTenantSettings="TemplatedAppNotAllowedByTenantSettings",e.TemplatedAppNotAllowedByUserPermissionPolicy="TemplatedAppNotAllowedByUserPermissionPolicy",e.TemplatedInstanceAppNotAllowed="TemplatedInstanceAppNotAllowed",e.GetTeamThreadFailed="GetTeamThreadFailed",e.GetTeamThreadsFailed="GetTeamThreadsFailed",e.GetChatThreadFailed="GetChatThreadFailed",e.GetTenantSettingsFailed="GetTenantSettingsFailed",e.NoPermissionToInstallApp="NoPermissionToInstallApp",e.NoPermissionToUpgradeApp="NoPermissionToUpgradeApp",e.NoPermissionToUploadCustomApp="NoPermissionToUploadCustomApp",e.FailedToCheckPermissionToManageApp="FailedToCheckPermissionToManageApp",e.AppIsTenantAdminBlocked="AppIsTenantAdminBlocked",e.AppUploadNotAllowedByTenant="AppUploadNotAllowedByTenant",e.AppUpdateNotAllowedByTenant="AppUpdateNotAllowedByTenant",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AddAppBotToChatRosterFailed="AddAppBotToChatRosterFailed",e.AddAppBotToTeamRosterFailed="AddAppBotToTeamRosterFailed",e.AddBotToRosterFailedMaxLimitReached="AddBotToRosterFailedMaxLimitReached",e.UserNotFoundInSkypeTeam="UserNotFoundInSkypeTeam",e.BotIdFormatIsIncorrect="BotIdFormatIsIncorrect",e.GuestNotAllowedToInstallApps="GuestNotAllowedToInstallApps",e.GuestNotAllowedToUpdateApps="GuestNotAllowedToUpdateApps",e.GuestNotAllowedToUpgradeApps="GuestNotAllowedToUpgradeApps",e.OperationNotAllowedOnInstalledAndDeprecatedApp="OperationNotAllowedOnInstalledAndDeprecatedApp",e.AnonymousUsersInteractionNotSupported="AnonymousUsersInteractionNotSupported",e.GetUserAppSetupPoliciesAsync="GetUserAppSetupPoliciesAsync",e.InvalidHostedAppOperationForbidden="InvalidHostedAppOperationForbidden",e.OperationNotAllowedOnArchivedTeam="OperationNotAllowedOnArchivedTeam",e.ClientNetworkOffline="ClientNetworkOffline"}(i||(i={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED"}(r||(r={}));const a="NoHttpStatusCode",s={statusKey:"status",errorCodeKey:"errorCode"};var o;!function(e){e[e.BotInputMenu=1]="BotInputMenu",e[e.BotMentions=2]="BotMentions",e[e.MessageExtension=3]="MessageExtension",e[e.MessageAction=4]="MessageAction",e[e.LinkUnfurling=5]="LinkUnfurling",e[e.Webhooks=6]="Webhooks",e[e.BotCards=7]="BotCards",e[e.ChatPane=8]="ChatPane",e[e.MeetingAppNotifications=9]="MeetingAppNotifications",e[e.AppDetails=10]="AppDetails",e[e.TcPickerNavigation=11]="TcPickerNavigation",e[e.Scenes=12]="Scenes",e[e.CallEscalation=13]="CallEscalation",e[e.VivaFeedback=14]="VivaFeedback",e[e.InContextStore=15]="InContextStore",e[e.MeetingAppsFlyout=16]="MeetingAppsFlyout",e[e.AppsFlyout=17]="AppsFlyout",e[e.FreDialog=18]="FreDialog",e[e.Compose=19]="Compose",e[e.Connectors=20]="Connectors",e[e.PreviewCardFooter=21]="PreviewCardFooter",e[e.ACV2CardJITInstall=22]="ACV2CardJITInstall",e[e.MessageExtensionCardFooter=23]="MessageExtensionCardFooter",e[e.TaskModule=24]="TaskModule",e[e.MessageExtensionFlyoutCommand=25]="MessageExtensionFlyoutCommand",e[e.MessageExtensionFlyoutCommandPostInstall=26]="MessageExtensionFlyoutCommandPostInstall",e[e.GetFetchCommandApps=27]="GetFetchCommandApps",e[e.PinnedMessageExtensions=28]="PinnedMessageExtensions",e[e.ChatRoster=29]="ChatRoster",e[e.NewChat=30]="NewChat"}(o||(o={}))},767867:(e,t,n)=>{n.d(t,{N6:()=>Z,vx:()=>Y,Z1:()=>K,NM:()=>W,at:()=>F,pW:()=>w,xR:()=>N,a:()=>M,KC:()=>R,S:()=>x,oD:()=>k,vc:()=>P,tN:()=>V,i4:()=>L,Y3:()=>z,M9:()=>U,HI:()=>q,Pe:()=>v,JU:()=>X,gF:()=>B,c2:()=>D});var i=n(364819),r=n(812228),a=n(802756),s=n(355515),o=n(34655),l=n(232122),d=n(66155),c=n(878344),p=n(362328);const u={kind:"Document",get definitions(){const e=(0,p.G)("query appImpressions($impressionProperty:String!) {appImpressions(impressionProperty:$impressionProperty) {appId,count}}");return delete this.definitions,this.definitions=e.definitions}};var m=n(693968);const h={kind:"Document",get definitions(){const e=(0,p.G)("mutation installApp($installScope:AppInstallScope!,$appId:ID!,$conversationId:String,$installParameters:AppInstallParametersInput) {installApp(installScope:$installScope,appId:$appId,conversationId:$conversationId,installParameters:$installParameters) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...m.B.definitions]}},g={kind:"Document",get definitions(){const e=(0,p.G)("mutation upgradeApp($installScope:AppInstallScope!,$appId:ID!,$conversationId:String) {upgradeApp(installScope:$installScope,appId:$appId,conversationId:$conversationId) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...m.B.definitions]}},f={kind:"Document",get definitions(){const e=(0,p.G)("mutation deleteApp($installedScope:AppInstallScope!,$appId:ID!,$conversationId:String,$deleteParameters:AppDeleteParametersInput) {deleteApp(installedScope:$installedScope,appId:$appId,conversationId:$conversationId,deleteParameters:$deleteParameters)}");return delete this.definitions,this.definitions=e.definitions}};var E=n(348763),y=n(777313),I=n(963647),A=n(792055),C=n(463996),T=n(23783),S=n(355552);const v=(e,t,n,i,r,a,s,o,d,c,p,u,m)=>{const g={installScope:r,appId:i,conversationId:o,installParameters:{appSource:m,isCopilotPlugin:c,hasAppEnableConsent:u}},f=t.newScenario(n);return f.appendEventData({"Thread.Id":o,"App.Id":i}),d&&f.appendEventData(d),Z(f,o),e.mutate({mutation:h,variables:g,update:_(e,g,a,s),context:{callerInfo:p}}).then((e=>{if(!(0,l.WX)(e)||!e.data?.installApp?.definition)throw new Error("unexpected response, install app failed");return f.stop(),e.data.installApp})).catch((e=>{const t=e&&e.message?(0,l.zh)(e.message):(0,l.TW)();throw t.includes(A.kb.ClientNetworkOffline)?f.cancel({errors:t}):f.fail({errors:t}),e}))},_=(e,{installScope:t,conversationId:n},i,r)=>(a,s)=>{try{const a=(0,l.WX)(s)&&s.data;a&&a.installApp?((0,E.Cg)({client:e,installedScope:t,conversationId:n,logger:i,enableAppsQueryOptimization:r},a.installApp),n||e.cache.modify({fields:{installedAppsForMesssageAction:(e,{DELETE:t})=>t}})):i.error("mutation update, install app failed")}catch(e){i.error("Failed to add app to client cache")}},D=(e,t,n,i,r,a,s,o,d)=>{const c={installScope:r,appId:i,conversationId:o},p=t.newScenario(n);return e.mutate({mutation:g,variables:c,update:b(e,c,a,s)}).then((e=>{if(!(0,l.LY)(e)||!e.data?.upgradeApp?.definition)throw new Error("unexpected response, upgrade app failed");return d?p.stop(d):p.stop(),e.data.upgradeApp})).catch((e=>{const t=e&&e.message?(0,l.zh)(e.message):(0,l.TW)();throw d?p.fail({...d,errors:t}):p.fail({errors:t}),e}))},b=(e,{installScope:t,conversationId:n},i,r)=>(a,s)=>{try{const a=(0,l.LY)(s)&&s.data;a&&a.upgradeApp?(0,E.Cg)({client:e,installedScope:t,conversationId:n,logger:i,enableAppsQueryOptimization:r},a.upgradeApp):i.error("mutation update, upgrade app failed")}catch(e){i.error("Failed to add app to client cache")}},P=async(e,t,n,i)=>{const r=["Personal"],s=i?.conversation,o={installedScopes:s?[...r,s.scope]:r,conversationId:s&&s.id,options:{capabilityFilter:i?.capabilityFilter}},l=t.newScenario(a.Cu.ExtInstalledApps);try{const t=await(0,C.hX)(e,o,"no-cache");l.mark(a.BQ.ExtAppsFetched);const i=t?.filter((e=>e&&e.definition&&e.id===n));return l.mark(a.BQ.ExtAppsProcessed),l.stop(),i}catch(e){return l.fail({errors:`failed to get installed app id: ${n}`}),[]}},N=async(e,t,n,i,r,a)=>{let l;n&&(l=i||"GroupChat");const{data:d,error:p}=await e.query({query:c.y,variables:{appId:t,scope:l,conversationId:n,options:{allowBlockedApps:a}},context:{callerInfo:`${r}-getAppDefinition`}});if(!d||!d.appDefinition||p){const e="Get AppDefinition failed";throw(0,s.$5)("AppsHelper",o.O4.NotPresent,"getAppDefinition",void 0,p?.message??e)}return d.appDefinition},M=async(e,t,n,i,r)=>{const{data:a,error:s}=await e.query({query:d.T,variables:t,context:{callerInfo:n}});if(!a||!a.appDefinitions){const e="Get AppDefinitions failed";if(r){r(`Fail to get App definitions, error message: ${s?.message}`)}throw new Error(e)}return i&&i(),a.appDefinitions},R=async(e,t,n,i)=>{const r=await M(e,{options:{capabilityFilter:["Messaging"]},conversationId:n,scope:i},"getAppDefinitionsByContext");return F(r,t)},F=(e,t)=>e.filter((e=>O(e,t))),w=(e,t,n,r,a,s)=>{if((0,i.isEmpty)(e))return e;if((0,i.isEmpty)(t))return[];let o=e.filter((e=>!!e&&!!e.name?.toLocaleLowerCase().includes(t?.toLocaleLowerCase())));if(n&&r&&(o=o.filter((e=>!!e&&!(0,i.includes)(e.blockedConfigurations,S.H.Federation))),a)){const e=s.map((e=>e.id));o=o.filter((t=>!!t&&(0,i.includes)(e,t.id)))}return o},O=(e,t)=>{if(!t)return!0;const n=e.messageExtensions??[];if(!(0,i.isEmpty)(n))for(const e of n)if((0,i.some)(e.commands,(e=>(0,I.kS)(e,t))))return!0;return!1},U=async e=>{const{client:t,logger:n,scenarioFactory:i,enableInstalledAppsV2:r,enableAppsQueryOptimization:a,entryPoint:s,isOneOnOneBotChat:o,scope:l,convId:d,botId:c}=e;let p={};d&&(p={conversation:o?void 0:{scope:l||"GroupChat",id:d},capabilityFilter:["Bot"],shouldFetchPersonalApps:o,botId:c,entryPoint:s});const u=r?await q(t,n,i,a,p,void 0):await G(t,n,i,p);if(r&&c){const e=u?.filter((e=>e.definition?.bots?.[0]?.id===c));return e}return u},L=async(e,t,n,i,r,a,s,o)=>i?await q(e,t,n,r,a,s,void 0,void 0,o):await G(e,t,n,a,s),k=async(e,t,n,i)=>{const r=n.newScenario(a.Cu.ExtGetSimpleAppModel);try{const t=await(0,C.Az)(e,i??"cache-only");return r.stop(),t}catch(e){const n="getAppInstalledByCurrentUser failed";return r.fail({errors:n}),t.warn(`${n} ${e}`),[]}},G=async(e,t,n,i,r)=>{const s=n.newScenario(a.Cu.ExtInstalledApps);try{const t=[];i?.shouldFetchPersonalApps&&t.push("Personal"),i?.conversation&&t.push(i.conversation.scope);const n=await(0,C.hX)(e,{installedScopes:t,conversationId:i?.conversation?.id,options:{capabilityFilter:i?.capabilityFilter,botId:i?.botId}},i?.fetchPolicy);s.mark(a.BQ.ExtAppsFetched);const o=B(n,r);return s.mark(a.BQ.ExtAppsProcessed),s.stop(),o}catch(e){const n=`getInstalledApps failed: ${i?.botId??""}`;return s.fail({errors:n}),t.warn(`${n} ${e}`),[]}},x=async(e,t,n,i,r)=>{const l={query:u,fetchPolicy:r??"network-only",variables:{impressionProperty:i}},d=n.newScenario(a.Cu.ExtGetAppImpression),c="Get AppImpressions failed";try{const{data:t}=await e.query(l);if(!t||!t.appImpressions)throw(0,s.$5)("AppsHelper",o.O4.NotPresent,"getAppImpressions",void 0,c);return d.stop(),t.appImpressions}catch(e){return d.fail({errors:c}),t.warnToTelemetry?.(`${c} ${e}`,"platform_appsframework_appscore_apps_helper"),[]}},B=(e,t,n)=>(0,r.compose)(i.compact,(0,r.map)((e=>$(e,t))),(0,r.filter)((e=>(0,l.xK)(e)&&j(e,n))))(e),$=(e,t)=>{if(!t)return e;let n=!1,r=[];if(e.definition.messageExtensions&&(r=e.definition.messageExtensions.map((e=>{let r=e;const a=e.commands??[];return(0,i.isEmpty)(e.commands)||(r={...e,commands:a.filter((e=>!!(0,I.kS)(e,t)&&(n=!0,!0)))}),r}))),!n)return null;const a=r.length?{...e.definition,messageExtensions:r}:e.definition;return{...e,definition:a}},H=(e,{appId:t,installedScope:n,conversationId:i},r,a)=>(s,{data:o})=>{try{o&&o.deleteApp?(0,E.G7)({client:e,installedScope:n,conversationId:i,logger:r,enableAppsQueryOptimization:a},t):r.error("mutation update, delete app failed")}catch(e){r.error("Failed to remove app from client cache")}},W=async(e,t,n,i,r,a,s)=>{const o=t.newScenario(n);o.appendEventData({"Thread.Id":r.conversationId??void 0,"App.Id":r.appId,templatedAppId:r?.deleteParameters?.templatedAppId??void 0,origin:s}),Z(o,r.conversationId);try{const t=await e.mutate({mutation:f,variables:r,update:H(e,r,i,a)});if(!t?.data?.deleteApp)throw new Error("unexpected response, delete app failed");return o.stop(),t}catch(e){throw o.fail({errors:`failed to delete app ${r.appId}`}),e}},V=async(e,t,n,i,r,s,o)=>{const l=o||{},d=n.newScenario(a.Cu.ExtInstalledAppsV2);try{const n=[];if(o?.enableInstalledAppQueryOptimization){if(d.appendEventData({dataSource:"installedApp query",correlationId:s}),l.shouldFetchPersonalApps){const t=e.query({query:T.p,variables:{installedScope:"Personal",appId:i},context:{callerInfo:`${s}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));n.push(t)}if(l.conversation&&l.conversation.id){const t=e.query({query:T.p,variables:{installedScope:l.conversation.scope,appId:i,conversationId:l.conversation.id},context:{callerInfo:`${s}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));n.push(t)}const t=(await Promise.all(n)).filter((e=>!!e));return d.mark(a.BQ.ExtAppsProcessed),d.stop({appCount:t.length}),t}{d.appendEventData({dataSource:"installedAppsV2 query",correlationId:s});const n=(await J(e,d,t,r,`${s}-getInstalledAppsByIdV2`,l)).filter((e=>e&&e.definition&&e.id===i));return d.mark(a.BQ.ExtAppsProcessed),d.stop(),n}}catch(e){return d.fail({errors:`failed to get installed app id: ${i}`}),[]}},q=async(e,t,n,i,r,s,o,l,d)=>{const c=n.newScenario(a.Cu.ExtInstalledAppsV2),p={"Thread.Id":r?.conversation?.id};r?.entryPoint&&(p["App.EntryPoint"]=A.gY[r.entryPoint]);try{const n=await J(e,c,t,i,r?.entryPoint?A.gY[r.entryPoint]:"getInstalledAppsV2",r,d),l=B(n,s,r);return c.mark(a.BQ.ExtAppsProcessed),c.stop(p),o&&o(),l}catch(e){const n=`getInstalledAppsV2 failed convId: ${r?.conversation?.id??""} botId: ${r?.botId??""}`;return c.fail({...p,errors:n}),l&&l(n),t.warn(`${n}`),[]}},z=async(e,t,n,i,r)=>{const a=n.newScenario(i);try{const n=await(0,C.gZ)(e,t,"network-only"),i=B(n);return a.stop(),i}catch{const e=`failed to get hosted installed apps for ${t}`;return a.fail({errors:e}),r.error(e),[]}},J=async(e,t,n,i,r,s,o)=>{let l;const{fetchPolicyForScope:d,fetchOptions:c}=await(0,y.HW)(e,n,s);let p=null,u=null;if(s?.shouldFetchPersonalApps){l={scope:"Personal",conversationId:s?.conversation?.id};p=(o?C.L5:C.kJ)(e,{installedContext:l,options:{includeUnconsentedApps:s.includeUnconsentedApps}},r,(0,y.or)(d.Personal)).then((e=>(t.mark(a.BQ.ExtAppsFetchedPersonalScope),n.log(`installedApps: ${e.length} scope: ${l.scope}`),e)))}s?.conversation&&s?.conversation.id&&(u=Q(e,t,n,i,s.conversation,d,r,o,s.capabilityFilter,s.includeUnconsentedApps));const m=[p||Promise.resolve([]),u||Promise.resolve([])],[h,g]=await Promise.all(m);return(0,y.J7)(e,n,c),h.concat(g)},Q=(e,t,n,i,r,s,o,l,d,c)=>{let p;const u=r.scope,m="Team"===r.scope,h={scope:u,conversationId:r.id},g=(0,y.or)(s[u]);return i&&!m?(p=(0,C.Am)(e,{conversationId:r.id,options:{includeUnconsentedApps:c}},g),t.mark(a.BQ.ExtAppsQueryInstalledAppsWithPreCheck)):(p=l?(0,C.L5)(e,{installedContext:h,options:{capabilityFilter:d}},o,g):(0,C.Tw)(e,{installedContext:h,options:{capabilityFilter:d,includeUnconsentedApps:c}},o,g),t.mark(a.BQ.ExtAppsQueryInstalledAppsV2)),p=p.then((e=>{n.log(`installedApps: ${e.length} scope: ${h.scope} conversationId: ${h.conversationId} enableInstalledAppsMsgActionsQueryOptimization: ${l}`);const i="Team"===u?a.BQ.ExtAppsFetchedTeamScope:a.BQ.ExtAppsFetchedGroupScope;return t.mark(i),e})),p},j=(e,t)=>{if((0,i.isEmpty)(t?.capabilityFilter))return!0;const n=e.definition;return(0,i.some)(t?.capabilityFilter,(e=>{switch(e){case"Messaging":return!(0,i.isEmpty)(n.messageExtensions);case"Tab":return!(0,i.isEmpty)(n.galleryTabs)||t?.enableStaticTabsPhase1&&!(0,i.isEmpty)(n.staticTabs);case"Bot":return!(0,i.isEmpty)(n.bots);case"Connector":return!(0,i.isEmpty)(n.connectors);case"CUSTOMBOT":return!(0,i.isEmpty)(n.customBots)}}))},K=(e,t,n)=>{let r=Y(e,t.bots)||Y(e,t.connectors)||Y(e,t.galleryTabs)||Y(e,t.staticTabs);if("Team"===e)return r;const a=Y(e,t.messageExtensions);if(r||(r=n?a&&((e,t)=>{let n=!1;return e.messageExtensions&&e.messageExtensions.map((e=>{let r=e;const a=e.commands??[];return(0,i.isEmpty)(e.commands)||(r={...e,commands:a.filter((e=>!!(0,I.kS)(e,t)&&(n=!0,!0)))}),r})),n})(t,"Compose"):a),"Personal"!==e)return r;const s=(t.meetingExtensionDefinition?.scenes?.length??0)>0,o=(t.meetingExtensionDefinition?.filters?.length??0)>0;return r||s||o},Y=(e,t)=>(0,i.some)(t,(t=>(0,i.includes)(t.scopes,e))),X=e=>!!e&&(e.toLowerCase().includes("replychainid")||e.toLowerCase().includes("messageid")),Z=(e,t)=>{X(t)&&e.appendEventData({"Thread.Type":"Channel"})}},241870:(e,t,n)=>{n.d(t,{N:()=>r});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("query appsInstalledByCurrentUser {appsInstalledByCurrentUser}");return delete this.definitions,this.definitions=e.definitions}}},733857:(e,t,n)=>{n.d(t,{n:()=>a});var i=n(362328),r=n(214919);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appsUsage {appsUsage {...appsUsageFields}}");return delete this.definitions,this.definitions=[...e.definitions,...r.j.definitions]}}},777313:(e,t,n)=>{n.d(t,{HW:()=>o,or:()=>p,J7:()=>d,zy:()=>c});var i=n(362328);const r={kind:"Document",get definitions(){const e=(0,i.G)("query platformAppsBatchFetchPolicy($options:[PlatformAppsFetchPolicyOptions!]!) {platformAppsBatchFetchPolicy(options:$options) @client(always:true) {id,scope,convId,forceNetworkFetch}}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("mutation DataClientPlatformUpdateAllAppsFetchPoliciesMutation($fetchSource:PlatformAppsFetchSource!) {updateAllPlatformAppsFetchPolicies(fetchSource:$fetchSource) @client}");return delete this.definitions,this.definitions=e.definitions}};var s=n(328789);const o=async(e,t,n)=>{const i={};let r=[];try{n?.shouldFetchPersonalApps&&(r=[{scope:"Personal"}]),n?.conversation&&n?.conversation.id&&(r=[...r,{scope:n.conversation.scope,convId:n.conversation.id}]);const i=await l(e,r);return t.log("getFetchPolicy for installedApps",i),{fetchPolicyForScope:i,fetchOptions:r}}catch(e){return t.error("getFetchPolicy for installedApps failed"),{fetchPolicyForScope:i,fetchOptions:r}}},l=async(e,t)=>{const{data:n}=await e.query({query:r,variables:{options:t}}),i={},a=n?.platformAppsBatchFetchPolicy?.reduce(((e,t)=>({...e,[t.scope]:t.forceNetworkFetch})),i);return a??i},d=(e,t,n,i)=>{const r=i??"Cache",a=n.map((e=>({...e,fetchSource:r})));return e.mutate({mutation:s.J,variables:{input:a}}).catch((e=>(t.error("failed to set fetch policy to ",r),Promise.resolve(void 0))))},c=(e,t,n)=>{e.mutate({mutation:a,variables:{fetchSource:n}}).catch((e=>{t.error("failed to update all fetch policies to ",n)}))},p=e=>e?"network-only":"cache-first"},23783:(e,t,n)=>{n.d(t,{p:()=>a});var i=n(362328),r=n(693968);const a={kind:"Document",get definitions(){const e=(0,i.G)("query installedApp($installedScope:AppInstallScope!,$appId:ID!,$conversationId:String) {installedApp(installedScope:$installedScope,appId:$appId,conversationId:$conversationId) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...r.B.definitions]}}},331187:(e,t,n)=>{n.d(t,{s:()=>a});var i=n(362328),r=n(693968);const a={kind:"Document",get definitions(){const e=(0,i.G)("query installedAppsV2($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsV2(installedContext:$installedContext,options:$options) {...installedAppFields,statusInfo {status}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.B.definitions]}}},463996:(e,t,n)=>{n.d(t,{Az:()=>A,g_:()=>I,Am:()=>f,hX:()=>T,gZ:()=>C,kJ:()=>y,Tw:()=>E,L5:()=>S});var i=n(331187),r=n(362328),a=n(693968);const s={kind:"Document",get definitions(){const e=(0,r.G)("query installedAppsForContainerApp($containerAppId:String!) {installedAppsForContainerApp(containerAppId:$containerAppId) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}},o={kind:"Document",get definitions(){const e=(0,r.G)("query installedChatAppsWithPreCheck($conversationId:String!,$options:InstalledAppsOptions) {installedChatAppsWithPreCheck(conversationId:$conversationId,options:$options) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}},l={kind:"Document",get definitions(){const e=(0,r.G)("query installedApps($installedScopes:[AppInstallScope!]!,$conversationId:String,$options:AppsFilterOptionsInput) {installedApps(installedScopes:$installedScopes,conversationId:$conversationId,options:$options) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}};var d=n(733857),c=n(241870),p=n(590438);const u={kind:"Document",get definitions(){const e=(0,r.G)("fragment DataFragmentsCommonAppDefinitionMsgActionFragment on AppDefinition {id,name,largeImageUrl,validDomains,accentColor,isFullScreenApp,isFullTrustApp,tenantId,externalId,isMicrosoftOwned,webApplicationInfo {id,resource},messageExtensions {type,botId,canUpdateConfiguration,fetchCommands,scopes,commands {id,title,context,description,initialRun,type,parameters {name,title,description,isRequired,inputType,choices {title,value}},appKey,fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}},authorization {authType,microsoftEntraConfiguration {supportsSingleSignOn}}}}");return delete this.definitions,this.definitions=e.definitions}},m={kind:"Document",get definitions(){const e=(0,r.G)("fragment DataFragmentsCommonInstalledAppMsgActionFragment on InstalledApp {id,installedScope,installationState,messageExtensionStates {...messageExtensionState},definition {...DataFragmentsCommonAppDefinitionMsgActionFragment},statusInfo {status}}");return delete this.definitions,this.definitions=[...e.definitions,...p.O.definitions,...u.definitions]}},h={kind:"Document",get definitions(){const e=(0,r.G)("query ComponentsAppsPlatformQueriesInstalledAppsV2MessageActionsQuery($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsForMesssageAction(installedContext:$installedContext,options:$options) {...DataFragmentsCommonInstalledAppMsgActionFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...m.definitions]}},g={kind:"Document",get definitions(){const e=(0,r.G)("query ComponentsAppsPlatformQueriesInstalledAppsForMessageActionQuery($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsForMesssageAction(installedContext:$installedContext,options:$options) {...installedAppFields,statusInfo {status}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}},f=async(e,t,n)=>{const{data:i}=await e.query({query:o,variables:t,fetchPolicy:n});return i&&i.installedChatAppsWithPreCheck?i.installedChatAppsWithPreCheck:[]},E=async(e,t,n,r)=>{const{data:a}=await e.query({query:i.s,variables:t,fetchPolicy:r,context:{callerInfo:n}});return a&&a.installedAppsV2?a.installedAppsV2:[]},y=async(e,t,n,i)=>{const{data:r}=await e.query({query:g,variables:t,fetchPolicy:i,context:{callerInfo:n}});return r&&r.installedAppsForMesssageAction?r.installedAppsForMesssageAction:[]},I=async(e,t)=>{const{data:n}=await e.query({query:d.n,fetchPolicy:t});return n?.appsUsage?n.appsUsage:{__typename:"AppsUsage",appIds:[],appActions:[],appScenes:[],appsMru:[],appCommands:[]}},A=async(e,t)=>{const n=await e.query({query:c.N,fetchPolicy:t}),{data:i}=n;return i?.appsInstalledByCurrentUser?i.appsInstalledByCurrentUser:[]},C=async(e,t,n)=>{const{data:i}=await e.query({query:s,variables:{containerAppId:t},fetchPolicy:n});return i?.installedAppsForContainerApp?i.installedAppsForContainerApp:[]},T=async(e,t,n)=>{const{data:i}=await e.query({query:l,variables:t,fetchPolicy:n});return i&&i.installedApps?i.installedApps:[]},S=async(e,t,n,i)=>{const{data:r}=await e.query({query:h,variables:t,fetchPolicy:i,context:{callerInfo:n}});return r?.installedAppsForMesssageAction?r.installedAppsForMesssageAction:[]}},348763:(e,t,n)=>{n.d(t,{Cg:()=>g,JU:()=>u,G7:()=>h});var i=n(364819),r=n(362328);const a={kind:"Document",get definitions(){const e=(0,r.G)("query installedAppsIdList($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsV2(installedContext:$installedContext,options:$options) {id,conversationId,installedScope,installedVersion}}");return delete this.definitions,this.definitions=e.definitions}};var s=n(777313);const o={kind:"Document",get definitions(){const e=(0,r.G)("query installedChatAppsIdsList($conversationId:String!,$options:InstalledAppsOptions) {installedChatAppsWithPreCheck(conversationId:$conversationId,options:$options) {id,conversationId,installedScope,installedVersion}}");return delete this.definitions,this.definitions=e.definitions}};var l=n(23783);const d=(e,t,n)=>"Personal"===e?{installedScope:e,appId:t}:{installedScope:e,appId:t,conversationId:n},c=(e,t)=>({installedContext:"Personal"===e?{scope:e}:{scope:e,conversationId:t}}),p=e=>({conversationId:e}),u=(e,t,n,i,r)=>{const a=n.newLogger("UpdateAppsCache","components-apps-platform-queries");try{if(!t.installedAppsUpdateEventV2)return;const{installedAppsUpdateEventV2:{installedScope:n,app:s,appId:o,eventType:l,conversationId:d}}=t,c={client:e,installedScope:n,conversationId:d,logger:a,enableAppsQueryOptimization:i};if(r&&"Personal"===n)return void m(n,d,e,a,r);switch(l){case"Added":g(c,s);break;case"Removed":h(c,o);break;case"Synced":m(n,d,e,a,r)}}catch(e){a.error("update apps cache failed")}},m=(e,t,n,i,r)=>{if(t&&("GroupChat"===e||"Team"===e)||!t&&"Personal"===e){if(r&&"Personal"===e)return void(0,s.zy)(n,i,"Network");let a=[];a=[{scope:e,convId:t}],(0,s.J7)(n,i,a,"Network")}},h=(e,t)=>{const{logger:n,client:r,installedScope:a,conversationId:s}=e;if((0,i.isNull)(t)||"Personal"!==a&&!s)return void n.warn("removeAppFromCache - invalid input",t,a,s);const o=d(a,t,s);try{r.writeQuery({query:l.p,variables:o,data:{installedApp:null}})}catch(e){throw n.error("removeAppFromCache - failed to update installedApp query",t,a,s),e}const c=E(e);if((0,i.isNull)(c))return void n.warn("removeAppFromCache - no apps in cache",t);const p=(0,i.filter)(c,(e=>null===e||e.id!==t));p.length!==c.length?(n.log("Removing from apps cache "),y(e,p)):n.warn("app to delete already removed from cache")},g=(e,t)=>{const{logger:n,client:r,installedScope:a,conversationId:s}=e;if((0,i.isNull)(t)||"Personal"!==a&&!s)return void n.warn("addAppToCache - invalid input",t,a,s);const{id:o,installedVersion:c,conversationId:p,__typename:u}=t,m=d(a,o,s);try{r.writeQuery({query:l.p,variables:m,data:{installedApp:t}})}catch(e){throw n.error("addAppToCache - failed to update installedApp query",t,a,s),e}const h=E(e);if((0,i.isNull)(h))return void n.warn("addAppToCache - no apps in cache",t);const g=t.id,f=(0,i.find)(h,(e=>e?.id===g));(0,i.isNil)(f)?(n.log("Adding to apps cache"),y(e,[...h,{id:o,conversationId:p,installedVersion:c,installedScope:a,__typename:u}])):n.warn("app to add already in cache",f)},f=(e,t)=>"GroupChat"===e&&t,E=({client:e,installedScope:t,conversationId:n,logger:i,enableAppsQueryOptimization:r})=>{try{if(f(t,r)){if(n){const t=e.readQuery({query:o,variables:p(n)});return t&&t.installedChatAppsWithPreCheck?t.installedChatAppsWithPreCheck:(i.warn("readQuery for group scope returned no results"),null)}return i.error("invalid convid for cache read"),null}{const r=e.readQuery({query:a,variables:c(t,n)});return r&&r.installedAppsV2?r.installedAppsV2:(i.warn("readQuery returned no results"),null)}}catch(e){throw e}},y=({client:e,installedScope:t,conversationId:n,enableAppsQueryOptimization:i,logger:r},s)=>{try{f(t,i)?n?e.writeQuery({query:o,variables:p(n),data:{installedChatAppsWithPreCheck:s}}):r.error("invalid convid for cache update"):e.writeQuery({query:a,variables:c(t,n),data:{installedAppsV2:s}})}catch(e){throw e}}},103502:(e,t,n)=>{var i;n.d(t,{i:()=>i}),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(i||(i={}))},963647:(e,t,n)=>{n.d(t,{Dr:()=>p,YB:()=>m,e1:()=>h,rh:()=>g,u2:()=>f,Ze:()=>E,dP:()=>y,Bd:()=>I,kS:()=>T,js:()=>v,Nv:()=>_,Jm:()=>P,OH:()=>N,sr:()=>F});var i=n(364819),r=n(812228),a=n(103502),s=n(46377),o=n(30728),l=n(988536);const d="Required",c=["Compose","Commandbox"],p=(e,t,n)=>{if(!t.id)return null;const i=I(t),a=A(t),s=i?u(i):null,[o,l]=(0,r.compose)((0,r.partition)(S),(0,r.map)((t=>D(e,t))),(0,r.filter)((e=>T(e,n))),C)(i);return{appInfo:a,validDomains:t.validDomains||[],type:i?.type,botId:i&&i.botId||"",actionCommands:o,queryCommands:l,authorization:s||void 0,galleryTabs:t.galleryTabs||[]}},u=e=>{if("ApiBased"!==e.type)return null;const{authorization:t}=e;return t&&"microsoftEntra"===t.authType&&t.microsoftEntraConfiguration?{authType:a.i.MicrosoftEntra,microsoftEntraConfiguration:{supportsSingleSignOn:!!t.microsoftEntraConfiguration.supportsSingleSignOn}}:{authType:a.i.None}},m=e=>!(0,i.isEmpty)(e.appInfo.tenantId),h=e=>{const t=(0,r.first)(e.messageExtensions),n=t&&t.botId||"";return`${s.gN.BotPrefix}${n}`},g=e=>e&&(0,i.isEmpty)(e.queryCommands)&&(0,i.isArray)(e.actionCommands)&&e.actionCommands.length>=1,f=e=>e&&(0,i.isEmpty)(e.queryCommands)&&(0,i.isArray)(e.actionCommands)&&1===e.actionCommands.length,E=e=>e&&(0,i.isEmpty)(e.queryCommands)&&(0,i.isArray)(e.actionCommands)&&e.actionCommands.length>1,y=e=>e&&(0,i.isArray)(e.queryCommands)&&e.queryCommands.length>1,I=e=>e&&(0,r.first)(e.messageExtensions),A=e=>({accentColor:e.accentColor||"",appId:e.id,appName:e.name||"",appIcon:e.largeImageUrl||"",isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,tenantId:e.tenantId||"",externalId:e.externalId||"",resource:e.webApplicationInfo?.resource||"",isMicrosoftOwned:e.isMicrosoftOwned||!1}),C=e=>e&&e.commands||[],T=(e,t)=>(0,i.isEmpty)(e.context)?(0,i.includes)(c,t):(0,i.includes)(e.context,t),S=e=>e&&(0,i.isString)(e.type)&&e.type.toLowerCase()==="Action".toLowerCase(),v=e=>{const t=I(e);if(t)return"ApiBased"===t.type?"ApiBased":"BotBased"},_=(e,t)=>(e=>"ApiBased"===e.type)(t)?e?`${s.gN.TeamsAppPrefix}${t.appInfo.appId}`:"":`${s.gN.BotPrefix}${t.botId}`,D=(e,t)=>({id:t.id,type:t.type||"Query",context:t.context,fetchTask:!!t.fetchTask,description:t.description,initialRun:!!t.initialRun,parameters:t.parameters,title:t.title||"",appKey:t.appKey,taskInfo:P(e,t.taskInfo,t.parameters)}),b=(e,t)=>{const n={};return e&&(n.title=e.title||"",n.height=F(e.height),n.width=F(e.width)||t),n},P=(e,t,n)=>{if(t?.url)return{...b(t),url:t.url};const i=M(n);if(i){const n=e.stringTranslate("extensibility","inputExtension_task_module_button_title");return i.addSubmitAction("submitButton",n,{id:"submitButton"}),{...b(t,o.j4.Large),card:i.getCard()}}return t?{...b(t)}:void 0},N=e=>M(e)?.getRawJson()??null,M=e=>{if(!e||(0,i.isEmpty)(e))return null;const t=new l.a;return e.forEach((e=>R(t,e))),t},R=(e,t)=>{if(!t)return;const n=t.title||"",i=t.name||"",r=t.description||"",a=t.value??void 0,s=t.isRequired??!1;switch(t.inputType||"Text"){case"Text":e.addTextInput(i,r,a,200,!1,{label:n,isRequired:s,errorMessage:d});break;case"Textarea":e.addTextInput(i,r,a,1e3,!0,{label:n,isRequired:s,errorMessage:d});break;case"Number":e.addNumberInput(i,r,a,{label:n,isRequired:s,errorMessage:d});break;case"Date":e.addDateInput(i,r,a,{label:n,isRequired:s,errorMessage:d});break;case"Time":e.addTimeInput(i,r,a,{label:n,isRequired:s,errorMessage:d});break;case"Toggle":e.addToggle(i,n,a,{isRequired:s,errorMessage:d});break;case"Choiceset":const o=(t.choices??[]).map((e=>({title:e.title??"",value:e.value??""})));e.addChoiceSet(i,n,!1,!0,o,a,{label:n,isRequired:s,errorMessage:d})}},F=e=>{if(!(0,i.isNil)(e))return w(e)?(0,i.isNil)(e.customValue)?void 0:e.customValue:O(e)?U(e):void 0},w=e=>"DimensionInFloat"===e.__typename,O=e=>"DimensionInString"===e.__typename,U=e=>{if((0,i.isNil)(e.predefinedValue))return;switch(e.predefinedValue.toLowerCase()){case"small":return o.j4.Small;case"medium":return o.j4.Medium;case"large":return o.j4.Large;default:return}}},790491:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(362328),r=n(605910);const a={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatQueriesChatQuery($convId:ID!) {chat(convId:$convId) {...ComponentsChatQueriesConversationFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...r.q.definitions]}}},605910:(e,t,n)=>{n.d(t,{q:()=>C});var i=n(362328),r=n(369847),a=n(466548),s=n(308696),o=n(441065),l=n(255368),d=n(690686),c=n(189737),p=n(703566),u=n(361891),m=n(858863),h=n(24706),g=n(502393),f=n(627750),E=n(566424),y=n(168328),I=n(40341),A=n(48377);const C={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsChatQueriesConversationFragment on Conversation {id,title,shortTitle,themeId,picture,isBotBlocked,isOneOnOne,isOneOnOneBotChat,isDisabled,disabledReason {code,newlyCreatedUserId},meetingChatPolicy,chatSubType,chatType,isSfB @client,isMeeting @client,isOneOnOne,isMuted,isFederated @client,isChannel,isHidden,isRead,isRetentionHorizonSet,isModerator,replyPermission,isAdmin,isUserAnonymous,substrateGroupId,importMetadata {importState},lastMessage {...lastMessageFields},me {...userFields},consumptionHorizon {...consumptionHorizonFields},consumptionHorizonBookmark {...consumptionHorizonBookmarkFields},userConsumptionHorizon {...consumptionHorizonBookmarkFields},memberIds,membersLimited {...userFields},memberDisplayNamesLimited,oneOnOneChatHeaderCallButtonValue,hasFederatedUser,hasTflConsumerUser,cfet,hasEnterpriseUser,hasUnknownConsumerUser,hasUnknownEnterpriseUser,hasUnresolvedFederatedUser,isImpersonation,hasImpersonation,isDeletedOrDead,hasTflSmsUnverifiedUser,hasTflSmsVerifiedUser,nonTeamsFederatedUserLimitedNames,nonTeamsFederatedUsersLength,isPrivateChatPolicyDefinedScenario,isChatDisabledForRecipients,guardianChatInfo,isInQuarantine,quarantineCounter,tflOffNetworkUser {...userFields},tflOffNetworkUserLength,hasBotMember,isUserMember,botMembers {id},userAdminSettings {adminDeleteEnabled,deleteMessagesEnabled},creator,meetingInformation {id,meetingType,startTime,endTime,meetingData {meetingCode,passcode,meetingUrl},iCalUid,resolvedSensitivityLabelId,isCopyRestrictionEnforced,tenantId,organizerId,meetingJoinUrl,scenario,isCancelled,...DataFragmentsCommonRecordingMessageMiFragment,messagingPolicy {textOnlyChat},templateDetails {id}},tenantId,chatDisabledContext @client {isUIDisabled,disabledReason,extendedData,lastUpdatedTime},interopConversationStatus,extendedDirectoryRedemptionRequired,hasExtendedDirectoryUsers,chatScheduleSuggestionSuppressUntil,chatHistoryHiddenTime,clearHistoryTime,userProperties {...userProperties},pinnedConversationItems {... on Message {...pinnedMessageItemFields}},addedBy,addedByTenantId,identityMaskEnabled,sensitivityLabel {id,isCopyBlocked},createdAt,lastJoinAt,isCommentStream,isCommentStreamMeetingStarted,isConversationThreadDeleted,avatarUrl,meetingChatType,...DataFragmentsCommonUseExternalTagFragment,...DataFragmentsCommonChatMtoTelemetryFragment,...DataFragmentsCommonChatWithMtoUserBannerFragment,...DataFragmentsCommonChatRecapFragment,...DataFragmentsCommonUseMtoUserBannerFragment,...DataFragmentsCommonChatPaneLayoutFragment,...DataFragmentsCommonChatAddMembersFragment,...DataFragmentsCommonChatSmartCardInfoFragment @nonreactive,awarenessLiveState {key,value},groupCopilotInfo {id,allowInstallation,allowInteraction},notes {id,isSynthesisAvailable,showConvergedUx},pendingBots,isConversationalUXEnabled,isChatPartialHistoryShared,anyMemberHasPartialHistoryAccess,meetingChatType,showRedDot,activeCall {...DataFragmentsCommonActiveCallFragment},isSkypeModeratedConversation,isSkypeConversation,pinnedMessages(pinnedMessageCallerSource:PINNED_MESSAGE_BANNER,first:1) {id,edges {cursor,node {id,...DataFragmentsCommonChatPinnedMessageFragment}}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.L.definitions,...a.x.definitions,...s.U.definitions,...o.q.definitions,...l.x.definitions,...d.p.definitions,...c.M.definitions,...p.n.definitions,...u.Y.definitions,...m.I.definitions,...h.W.definitions,...g.P.definitions,...f.F.definitions,...E.h.definitions,...y._.definitions,...I.n.definitions,...A.Y.definitions]}}},833700:(e,t,n)=>{n.d(t,{v6:()=>i,Nr:()=>r,Lx:()=>a,Hy:()=>s,$j:()=>o,te:()=>l,kc:()=>d,Wj:()=>c,I5:()=>p,XJ:()=>h,yj:()=>f,r2:()=>E,R$:()=>y,BK:()=>I,Rp:()=>A,Q$:()=>C,g0:()=>T,Jr:()=>S,Jh:()=>v,wu:()=>_,qf:()=>D,_l:()=>b,MI:()=>P});const i="resourceRequiresConsent",r="resourceRequiresMfa",a="InteractionRequired",s="tokenRevoked",o="list-chiclet-icon",l="list-item-chiclet-icon",d="list-form-chiclet-icon",c="list-playlist-chiclet-icon";var p,u,m;!function(e){e.Chat="chat",e.MeetingChat="meetingChat",e.HoloLensChat="holoLensChat",e.EmbedFeedbackChat="embedFeedbackChat",e.SmartReply="smartReply",e.MeetingPPT="meetingPPT",e.Channel="channel",e.ChannelMeeting="channelMeeting",e.ChannelMeetingPPT="channelMeetingPPT",e.ChatFilesTab="chatFilesTab",e.Unknown="unknown"}(p||(p={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(u||(u={})),function(e){e[e.Recent=0]="Recent",e[e.Aggregate=1]="Aggregate",e[e.Personal=2]="Personal",e[e.Teams=3]="Teams",e[e.Channels=4]="Channels",e[e.Downloads=5]="Downloads",e[e.PersonalWopi=6]="PersonalWopi",e[e.PersonalGoogle=7]="PersonalGoogle",e[e.CustomSpo=8]="CustomSpo",e[e.SharedWithMe=9]="SharedWithMe",e[e.Chats=10]="Chats"}(m||(m={}));const h=(new Map).set("Sharepoint",u.Sharepoint).set("WOPI",u.WOPI).set("Google",u.Google).set("OneDrive",u.OneDrive).set("Recent",u.Recent).set("Aggregate",u.Aggregate).set("FileSystem",u.FileSystem).set("Search",u.Search).set("AllFiles",u.AllFiles).set("SharedWithMe",u.SharedWithMe);var g,f,E;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google"}(g||(g={})),function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE"}(f||(f={})),function(e){e.Secure="Secure",e.InvalidFormat="InvalidFormat",e.InvalidProtocol="InvalidProtocol",e.InvalidExternalProviderDomain="InvalidExternalProviderDomain",e.DomainMismatchForDifferentUrl="DomainMismatchForDifferentUrl",e.InvalidInternalDomain="InvalidInternalDomain",e.ObjectUrlMissing="ObjectUrlMissing"}(E||(E={}));const y=new Map;y.set("DROPBOX",g.WopiIntegration).set("BOX",g.WopiIntegration).set("SHAREFILE",g.WopiIntegration).set("EGNYTE",g.WopiIntegration).set("GOOGLEDRIVE",g.Google);const I=new Map;I.set(u.Sharepoint,"Sharepoint").set(u.WOPI,"WOPI").set(u.Google,"Google").set(u.OneDrive,"OneDrive").set(u.Recent,"Recent").set(u.Aggregate,"Aggregate").set(u.FileSystem,"FileSystem").set(u.Search,"Search").set(u.AllFiles,"AllFiles").set(u.SharedWithMe,"SharedWithMe");const A=new Map;A.set("DROPBOX",f.Dropbox).set("BOX",f.Box).set("SHAREFILE",f.Sharefile).set("GOOGLEDRIVE",f.GoogleDrive).set("EGNYTE",f.Egnyte);const C=new Map;C.set("Recent",m.Recent).set("Aggregate",m.Aggregate).set("Personal",m.Personal).set("Teams",m.Teams).set("Channels",m.Channels).set("Downloads",m.Downloads).set("PersonalWopi",m.PersonalWopi).set("PersonalGoogle",m.PersonalGoogle).set("CustomSpo",m.CustomSpo).set("SharedWithMe",m.SharedWithMe).set("Chats",m.Chats);const T=e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}},S=e=>{switch(e){case u.Sharepoint:return"Sharepoint";case u.WOPI:return"WOPI";case u.Google:return"Google";case u.OneDrive:return"OneDrive";case u.Recent:return"Recent";case u.Aggregate:return"Aggregate";case u.FileSystem:return"FileSystem";case u.Search:return"Search";case u.AllFiles:return"AllFiles";case u.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}},v="https://teams.microsoft.com/scripts/items-view-strings.js",_=/[\u202A-\u202E\u2066-\u2069]/g,D="",b=/[\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\uFB1D-\uFB4F\uFB50-\uFDFF\uFE70-\uFEFF]/,P="GetValidFileDomains"},78643:(e,t,n)=>{n.d(t,{u:()=>l,C:()=>d});var i=n(957032),r=n(364819),a=n(513432),s=n(185904);const o=a.createContext(void 0),l=e=>{const{children:t,...n}=e,a={...n,activeWindowService:n.activeWindowsService.getWindowLayoutService(n.windowId),context:{hostCommunicationService:n.hostCommunicationService}};return(0,i.Y)(o.Provider,{value:(0,s.F)(a,r.isEqual),children:t})},d=()=>a.useContext(o)}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/889618-abda4a70a26a76b0.js.map